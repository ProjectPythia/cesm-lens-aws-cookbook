
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reproducing Key Figures from Kay et al. (2015) &#8212; CESM LENS on AWS Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css?v=e502140d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=6b4ca61d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-T52X8HNYE8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-T52X8HNYE8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/example-workflows/key-figures';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Enhanced Intake-ESM Catalog Demo" href="../foundations/enhanced-catalog.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="1 April 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>

  
  <div class="pst-scroll-pixel-helper"></div>
    <header class="bd-header navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

   

<a class="navbar-brand logo" href="https://projectpythia.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pythia_logo-white-rtext.svg" class="logo__image only-light" alt="CESM LENS on AWS Cookbook - Home"/>
    <script>document.write(`<img src="../../_static/pythia_logo-white-rtext.svg" class="logo__image only-dark" alt="CESM LENS on AWS Cookbook - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ProjectPythia" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/project_pythia" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
        
        
        
        <div class="bd-sidebar-primary bd-sidebar">
          

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ProjectPythia" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/project_pythia" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    CESM LENS on AWS Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../how-to-cite.html">How to Cite This Cookbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../foundations/enhanced-catalog.html">Enhanced Intake-ESM Catalog Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Example workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reproducing Key Figures from Kay et al. (2015)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


        </div>

        
        <main id="main-content" class="bd-main" role="main">
          

            <div class="bd-content">

              <div class="bd-article-container">

                
                  
                  
<div id="searchbox"></div>
                  <article class="bd-article">
                    
  <p><a class="reference internal" href="../../_images/thumbnail.png"><img alt="CESM LENS image" src="../../_images/thumbnail.png" style="width: 250px;" /></a></img></p>
<section class="tex2jax_ignore mathjax_ignore" id="reproducing-key-figures-from-kay-et-al-2015">
<h1>Reproducing Key Figures from Kay et al. (2015)<a class="headerlink" href="#reproducing-key-figures-from-kay-et-al-2015" title="Link to this heading"><i class="fas fa-link"></i></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>This notebook demonstrates how one might use the NCAR Community Earth System Model (CESM) Large Ensemble (LENS) data hosted on AWS S3. The notebook shows how to reproduce figures 2 and 4 from the <a class="reference external" href="https://doi.org/10.1175/BAMS-D-13-00255.1">Kay et al. (2015) paper</a> describing the CESM LENS dataset.</p>
<p>This resource is intended to be helpful for people not familiar with elements of the <a class="reference external" href="https://pangeo.io/">Pangeo</a> framework including Jupyter Notebooks, <a class="reference external" href="https://docs.xarray.dev/en/stable/">Xarray</a>, and <a class="reference external" href="https://zarr.readthedocs.io/en/stable/">Zarr</a> data format, or with the original paper, so it includes additional explanation.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/xarray-intro.html">Intro to Xarray</a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Dask</p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 30 minutes</p></li>
</ul>
<hr class="docutils" />
<div class="alert alert-warning"><b>NOTE: </b>In this notebook, we access very large cloud-served datasets and use <a href="https://dask.org">Dask</a> to parallelize our workflow. The end-to-end execution time may be on the order of an hour or more, depending on your computing resources.</div></section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">intake</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">cmaps</span>  <span class="c1"># for NCL colormaps</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">dask</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dask</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">({</span><span class="s2">&quot;distributed.scheduler.worker-saturation&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;dask.config.set at 0x7f87ee7f3bf0&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-and-connect-to-dask-distributed-cluster">
<h2>Create and Connect to Dask Distributed Cluster<a class="headerlink" href="#create-and-connect-to-dask-distributed-cluster" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Here we’ll use a dask cluster to parallelize our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">platform</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span>

<span class="k">if</span> <span class="p">(</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">multiprocessing.popen_spawn_win32</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">multiprocessing.popen_spawn_posix</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-4bd2f3c2-f074-11ee-89e7-000d3a628e99</p>
        <table style="width: 100%; text-align: left;">

        <tr>
        
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>
        
        </tr>

        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>
        

        </table>

        

        
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">d3233fde</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 4
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 4
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 15.61 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-6370512b-032f-4e65-85a1-85098f3afa53</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:36585
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 15.61 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:41327
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:33665/status" target="_blank">http://127.0.0.1:33665/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:35383
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-pbw0r6_s
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:33511
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:45579/status" target="_blank">http://127.0.0.1:45579/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:42955
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-86pymuyl
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:42673
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:35429/status" target="_blank">http://127.0.0.1:35429/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:33207
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-aic6kyzl
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:34569
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:45451/status" target="_blank">http://127.0.0.1:45451/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37231
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-62ethmjs
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div>
            </details>
        

    </div>
</div></div></div>
</div>
</section>
<section id="load-and-prepare-data">
<h2>Load and Prepare Data<a class="headerlink" href="#load-and-prepare-data" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catalog_url</span> <span class="o">=</span> <span class="s1">&#39;https://ncar-cesm-lens.s3-us-west-2.amazonaws.com/catalogs/aws-cesm1-le.json&#39;</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">)</span>
<span class="n">col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>aws-cesm1-le catalog with 56 dataset(s) from 442 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>variable</th>
      <td>78</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>75</td>
    </tr>
    <tr>
      <th>component</th>
      <td>5</td>
    </tr>
    <tr>
      <th>experiment</th>
      <td>4</td>
    </tr>
    <tr>
      <th>frequency</th>
      <td>6</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>3</td>
    </tr>
    <tr>
      <th>spatial_domain</th>
      <td>5</td>
    </tr>
    <tr>
      <th>units</th>
      <td>25</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>12</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>13</td>
    </tr>
    <tr>
      <th>path</th>
      <td>427</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Show the first few lines of the catalog:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>long_name</th>
      <th>component</th>
      <th>experiment</th>
      <th>frequency</th>
      <th>vertical_levels</th>
      <th>spatial_domain</th>
      <th>units</th>
      <th>start_time</th>
      <th>end_time</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FLNS</td>
      <td>net longwave flux at surface</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FLNS....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FLNSC</td>
      <td>clearsky net longwave flux at surface</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FLNSC...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FLUT</td>
      <td>upwelling longwave flux at top of model</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FLUT....</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FSNS</td>
      <td>net solar flux at surface</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FSNS....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FSNSC</td>
      <td>clearsky net solar flux at surface</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FSNSC...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FSNTOA</td>
      <td>net solar flux at top of atmosphere</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-FSNTO...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ICEFRAC</td>
      <td>fraction of sfc area covered by sea-ice</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>fraction</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-ICEFR...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>LHFLX</td>
      <td>surface latent heat flux</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>W/m2</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-LHFLX...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PRECL</td>
      <td>large-scale (stable) precipitation rate (liq +...</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>m/s</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-PRECL...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PRECSC</td>
      <td>convective snow rate (water equivalent)</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>m/s</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-PRECS...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Show expanded version of collection structure with details:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span><span class="o">.</span><span class="n">keys_info</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
      <th>experiment</th>
      <th>frequency</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>atm.20C.daily</th>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
    </tr>
    <tr>
      <th>atm.20C.hourly6-1990-2005</th>
      <td>atm</td>
      <td>20C</td>
      <td>hourly6-1990-2005</td>
    </tr>
    <tr>
      <th>atm.20C.monthly</th>
      <td>atm</td>
      <td>20C</td>
      <td>monthly</td>
    </tr>
    <tr>
      <th>atm.20C.static</th>
      <td>atm</td>
      <td>20C</td>
      <td>static</td>
    </tr>
    <tr>
      <th>atm.CTRL.daily</th>
      <td>atm</td>
      <td>CTRL</td>
      <td>daily</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="extract-data-needed-to-construct-figure-2">
<h3>Extract data needed to construct Figure 2<a class="headerlink" href="#extract-data-needed-to-construct-figure-2" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Search the catalog to find the desired data, in this case the reference height temperature of the atmosphere, at daily time resolution, for the Historical, 20th Century, and RCP8.5 (IPCC Representative Concentration Pathway 8.5) experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_subset</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;daily&quot;</span><span class="p">,</span> <span class="s2">&quot;monthly&quot;</span><span class="p">],</span> <span class="n">component</span><span class="o">=</span><span class="s2">&quot;atm&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;TREFHT&quot;</span><span class="p">,</span>
                        <span class="n">experiment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;20C&quot;</span><span class="p">,</span> <span class="s2">&quot;RCP85&quot;</span><span class="p">,</span> <span class="s2">&quot;HIST&quot;</span><span class="p">])</span>

<span class="n">col_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>aws-cesm1-le catalog with 6 dataset(s) from 6 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>variable</th>
      <td>1</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>1</td>
    </tr>
    <tr>
      <th>component</th>
      <td>1</td>
    </tr>
    <tr>
      <th>experiment</th>
      <td>3</td>
    </tr>
    <tr>
      <th>frequency</th>
      <td>2</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>spatial_domain</th>
      <td>1</td>
    </tr>
    <tr>
      <th>units</th>
      <td>1</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>6</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>6</td>
    </tr>
    <tr>
      <th>path</th>
      <td>6</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_subset</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>long_name</th>
      <th>component</th>
      <th>experiment</th>
      <th>frequency</th>
      <th>vertical_levels</th>
      <th>spatial_domain</th>
      <th>units</th>
      <th>start_time</th>
      <th>end_time</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>20C</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>1920-01-01 12:00:00</td>
      <td>2005-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-20C-TREFH...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>HIST</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>1850-01-01 12:00:00</td>
      <td>1919-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-HIST-TREF...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>RCP85</td>
      <td>daily</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>2006-01-01 12:00:00</td>
      <td>2100-12-31 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/daily/cesmLE-RCP85-TRE...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>20C</td>
      <td>monthly</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>1920-01-16 12:00:00</td>
      <td>2005-12-16 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/monthly/cesmLE-20C-TRE...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>HIST</td>
      <td>monthly</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>1850-01-16 12:00:00</td>
      <td>1919-12-16 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/monthly/cesmLE-HIST-TR...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TREFHT</td>
      <td>reference height temperature</td>
      <td>atm</td>
      <td>RCP85</td>
      <td>monthly</td>
      <td>1.0</td>
      <td>global</td>
      <td>K</td>
      <td>2006-01-16 12:00:00</td>
      <td>2100-12-16 12:00:00</td>
      <td>s3://ncar-cesm-lens/atm/monthly/cesmLE-RCP85-T...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Load catalog entries for subset into a dictionary of Xarray Datasets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsets</span> <span class="o">=</span> <span class="n">col_subset</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span><span class="n">zarr_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;consolidated&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;anon&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dataset dictionary keys:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">dsets</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;component.experiment.frequency&#39;
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='6' class='' max='6' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [6/6 00:04&lt;00:00]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset dictionary keys:
 dict_keys([&#39;atm.HIST.monthly&#39;, &#39;atm.HIST.daily&#39;, &#39;atm.20C.monthly&#39;, &#39;atm.20C.daily&#39;, &#39;atm.RCP85.monthly&#39;, &#39;atm.RCP85.daily&#39;])
</pre></div>
</div>
</div>
</div>
<p>Define Xarray Datasets corresponding to the three experiments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_HIST</span> <span class="o">=</span> <span class="n">dsets</span><span class="p">[</span><span class="s1">&#39;atm.HIST.monthly&#39;</span><span class="p">]</span>
<span class="n">ds_20C</span> <span class="o">=</span> <span class="n">dsets</span><span class="p">[</span><span class="s1">&#39;atm.20C.daily&#39;</span><span class="p">]</span>
<span class="n">ds_RCP85</span> <span class="o">=</span> <span class="n">dsets</span><span class="p">[</span><span class="s1">&#39;atm.RCP85.daily&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">dask.distributed</span></code> utility function to display size of each dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.utils</span> <span class="kn">import</span> <span class="n">format_bytes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Historical: </span><span class="si">{</span><span class="n">format_bytes</span><span class="p">(</span><span class="n">ds_HIST</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;20th Century: </span><span class="si">{</span><span class="n">format_bytes</span><span class="p">(</span><span class="n">ds_20C</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="sa">f</span><span class="s2">&quot;RCP8.5: </span><span class="si">{</span><span class="n">format_bytes</span><span class="p">(</span><span class="n">ds_RCP85</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Historical: 177.21 MiB
20th Century: 258.65 GiB
RCP8.5: 285.71 GiB
</pre></div>
</div>
</div>
</div>
<p>Now, extract the Reference Height Temperature data variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_hist</span> <span class="o">=</span> <span class="n">ds_HIST</span><span class="p">[</span><span class="s2">&quot;TREFHT&quot;</span><span class="p">]</span>
<span class="n">t_20c</span> <span class="o">=</span> <span class="n">ds_20C</span><span class="p">[</span><span class="s2">&quot;TREFHT&quot;</span><span class="p">]</span>
<span class="n">t_rcp</span> <span class="o">=</span> <span class="n">ds_RCP85</span><span class="p">[</span><span class="s2">&quot;TREFHT&quot;</span><span class="p">]</span>
<span class="n">t_20c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;TREFHT&#x27; (member_id: 40, time: 31390, lat: 192, lon: 288)&gt; Size: 278GB
dask.array&lt;open_dataset-TREFHT, shape=(40, 31390, 192, 288), dtype=float32, chunksize=(1, 576, 192, 288), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat        (lat) float64 2kB -90.0 -89.06 -88.12 -87.17 ... 88.12 89.06 90.0
  * lon        (lon) float64 2kB 0.0 1.25 2.5 3.75 ... 355.0 356.2 357.5 358.8
  * member_id  (member_id) int64 320B 1 2 3 4 5 6 7 ... 35 101 102 103 104 105
  * time       (time) object 251kB 1920-01-01 12:00:00 ... 2005-12-31 12:00:00
Attributes:
    cell_methods:  time: mean
    long_name:     Reference height temperature
    units:         K</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'TREFHT'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>member_id</span>: 40</li><li><span class='xr-has-index'>time</span>: 31390</li><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 288</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-89bd837a-08e1-4014-b4d1-cfc9c48ce156' class='xr-array-in' type='checkbox' checked><label for='section-89bd837a-08e1-4014-b4d1-cfc9c48ce156' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 576, 192, 288), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 258.65 GiB </td>
                        <td> 121.50 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (40, 31390, 192, 288) </td>
                        <td> (1, 576, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2200 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="336" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="0" y1="0" x2="0" y2="25" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="23" y1="0" x2="23" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >40</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="95" y1="25" x2="165" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="25" style="stroke-width:2" />
  <line x1="96" y1="1" x2="96" y2="26" />
  <line x1="98" y1="3" x2="98" y2="29" />
  <line x1="101" y1="6" x2="101" y2="31" />
  <line x1="102" y1="7" x2="102" y2="33" />
  <line x1="105" y1="10" x2="105" y2="35" />
  <line x1="107" y1="12" x2="107" y2="38" />
  <line x1="110" y1="15" x2="110" y2="40" />
  <line x1="111" y1="16" x2="111" y2="42" />
  <line x1="114" y1="19" x2="114" y2="44" />
  <line x1="117" y1="22" x2="117" y2="47" />
  <line x1="118" y1="23" x2="118" y2="48" />
  <line x1="120" y1="25" x2="120" y2="51" />
  <line x1="123" y1="28" x2="123" y2="53" />
  <line x1="126" y1="31" x2="126" y2="56" />
  <line x1="127" y1="32" x2="127" y2="57" />
  <line x1="129" y1="34" x2="129" y2="60" />
  <line x1="132" y1="37" x2="132" y2="62" />
  <line x1="133" y1="38" x2="133" y2="64" />
  <line x1="136" y1="41" x2="136" y2="66" />
  <line x1="139" y1="44" x2="139" y2="69" />
  <line x1="141" y1="46" x2="141" y2="72" />
  <line x1="142" y1="47" x2="142" y2="73" />
  <line x1="145" y1="50" x2="145" y2="75" />
  <line x1="148" y1="53" x2="148" y2="78" />
  <line x1="149" y1="54" x2="149" y2="79" />
  <line x1="151" y1="56" x2="151" y2="82" />
  <line x1="154" y1="59" x2="154" y2="84" />
  <line x1="157" y1="62" x2="157" y2="87" />
  <line x1="158" y1="63" x2="158" y2="88" />
  <line x1="161" y1="66" x2="161" y2="91" />
  <line x1="163" y1="68" x2="163" y2="94" />
  <line x1="165" y1="70" x2="165" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 165.58823529411765,70.58823529411765 165.58823529411765,96.00085180870013 95.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="96" y1="1" x2="121" y2="1" />
  <line x1="98" y1="3" x2="124" y2="3" />
  <line x1="101" y1="6" x2="126" y2="6" />
  <line x1="102" y1="7" x2="128" y2="7" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="107" y1="12" x2="133" y2="12" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="111" y1="16" x2="137" y2="16" />
  <line x1="114" y1="19" x2="139" y2="19" />
  <line x1="117" y1="22" x2="142" y2="22" />
  <line x1="118" y1="23" x2="143" y2="23" />
  <line x1="120" y1="25" x2="146" y2="25" />
  <line x1="123" y1="28" x2="148" y2="28" />
  <line x1="126" y1="31" x2="151" y2="31" />
  <line x1="127" y1="32" x2="152" y2="32" />
  <line x1="129" y1="34" x2="155" y2="34" />
  <line x1="132" y1="37" x2="157" y2="37" />
  <line x1="133" y1="38" x2="159" y2="38" />
  <line x1="136" y1="41" x2="161" y2="41" />
  <line x1="139" y1="44" x2="164" y2="44" />
  <line x1="141" y1="46" x2="167" y2="46" />
  <line x1="142" y1="47" x2="168" y2="47" />
  <line x1="145" y1="50" x2="170" y2="50" />
  <line x1="148" y1="53" x2="173" y2="53" />
  <line x1="149" y1="54" x2="174" y2="54" />
  <line x1="151" y1="56" x2="177" y2="56" />
  <line x1="154" y1="59" x2="179" y2="59" />
  <line x1="157" y1="62" x2="182" y2="62" />
  <line x1="158" y1="63" x2="183" y2="63" />
  <line x1="161" y1="66" x2="186" y2="66" />
  <line x1="163" y1="68" x2="189" y2="68" />
  <line x1="165" y1="70" x2="191" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="120" y1="0" x2="191" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 191.00085180870013,70.58823529411765 165.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="165" y1="70" x2="191" y2="70" style="stroke-width:2" />
  <line x1="165" y1="96" x2="191" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="165" y1="70" x2="165" y2="96" style="stroke-width:2" />
  <line x1="191" y1="70" x2="191" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="165.58823529411765,70.58823529411765 191.00085180870013,70.58823529411765 191.00085180870013,96.00085180870013 165.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="178.294544" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="211.000852" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,211.000852,83.294544)">192</text>
  <text x="120.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,120.294118,80.706734)">31390</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-5cceea89-c236-4791-89ff-dcadd16168c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5cceea89-c236-4791-89ff-dcadd16168c6' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.06 -88.12 ... 89.06 90.0</div><input id='attrs-e39d5ad7-b190-4488-a40e-a5688da89261' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e39d5ad7-b190-4488-a40e-a5688da89261' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af17a1d4-32a6-4a50-97dd-5af330d42826' class='xr-var-data-in' type='checkbox'><label for='data-af17a1d4-32a6-4a50-97dd-5af330d42826' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.057594, -88.115181, -87.172775, -86.23037 , -85.287956,
       -84.345551, -83.403145, -82.460732, -81.518326, -80.575912, -79.633507,
       -78.691101, -77.748688, -76.806282, -75.863876, -74.921463, -73.979057,
       -73.036652, -72.094238, -71.151833, -70.209427, -69.267014, -68.324608,
       -67.382202, -66.439789, -65.497383, -64.554977, -63.612564, -62.670158,
       -61.727749, -60.785339, -59.842934, -58.900524, -57.958115, -57.015705,
       -56.073299, -55.13089 , -54.18848 , -53.246075, -52.303665, -51.361256,
       -50.41885 , -49.47644 , -48.534031, -47.591621, -46.649216, -45.706806,
       -44.764397, -43.821991, -42.879581, -41.937172, -40.994766, -40.052357,
       -39.109947, -38.167538, -37.225132, -36.282722, -35.340313, -34.397907,
       -33.455498, -32.513088, -31.570681, -30.628273, -29.685863, -28.743456,
       -27.801046, -26.858639, -25.916231, -24.973822, -24.031414, -23.089005,
       -22.146597, -21.204189, -20.26178 , -19.319372, -18.376963, -17.434555,
       -16.492147, -15.549738, -14.607329, -13.664922, -12.722513, -11.780105,
       -10.837696,  -9.895288,  -8.95288 ,  -8.010471,  -7.068063,  -6.125654,
        -5.183246,  -4.240838,  -3.298429,  -2.356021,  -1.413613,  -0.471204,
         0.471204,   1.413613,   2.356021,   3.298429,   4.240838,   5.183246,
         6.125654,   7.068063,   8.010471,   8.95288 ,   9.895288,  10.837696,
        11.780105,  12.722513,  13.664922,  14.607329,  15.549738,  16.492147,
        17.434555,  18.376963,  19.319372,  20.26178 ,  21.204189,  22.146597,
        23.089005,  24.031414,  24.973822,  25.916231,  26.858639,  27.801046,
        28.743456,  29.685863,  30.628273,  31.570681,  32.513088,  33.455498,
        34.397907,  35.340313,  36.282722,  37.225132,  38.167538,  39.109947,
        40.052357,  40.994766,  41.937172,  42.879581,  43.821991,  44.764397,
        45.706806,  46.649216,  47.591621,  48.534031,  49.47644 ,  50.41885 ,
        51.361256,  52.303665,  53.246075,  54.18848 ,  55.13089 ,  56.073299,
        57.015705,  57.958115,  58.900524,  59.842934,  60.785339,  61.727749,
        62.670158,  63.612564,  64.554977,  65.497383,  66.439789,  67.382202,
        68.324608,  69.267014,  70.209427,  71.151833,  72.094238,  73.036652,
        73.979057,  74.921463,  75.863876,  76.806282,  77.748688,  78.691101,
        79.633507,  80.575912,  81.518326,  82.460732,  83.403145,  84.345551,
        85.287956,  86.23037 ,  87.172775,  88.115181,  89.057594,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.25 2.5 ... 356.2 357.5 358.8</div><input id='attrs-1208cf3a-c58b-4ba3-857c-f176b59790bf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1208cf3a-c58b-4ba3-857c-f176b59790bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c7cac07-50e6-4c2e-a7bc-a6a73a797adc' class='xr-var-data-in' type='checkbox'><label for='data-3c7cac07-50e6-4c2e-a7bc-a6a73a797adc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0.  ,   1.25,   2.5 , ..., 356.25, 357.5 , 358.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>member_id</span></div><div class='xr-var-dims'>(member_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 101 102 103 104 105</div><input id='attrs-92351cf0-e285-450d-8754-1e5ae2076ec8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-92351cf0-e285-450d-8754-1e5ae2076ec8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca6dfc86-7b97-43e7-a283-83b4e3bf9f6b' class='xr-var-data-in' type='checkbox'><label for='data-ca6dfc86-7b97-43e7-a283-83b4e3bf9f6b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,
        29,  30,  31,  32,  33,  34,  35, 101, 102, 103, 104, 105])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1920-01-01 12:00:00 ... 2005-12-...</div><input id='attrs-c6499e3a-1e83-443a-8b94-1d0da52b5ba1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6499e3a-1e83-443a-8b94-1d0da52b5ba1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9810b67f-ac02-4bc9-8e73-3a610185037c' class='xr-var-data-in' type='checkbox'><label for='data-9810b67f-ac02-4bc9-8e73-3a610185037c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1920, 1, 1, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1920, 1, 2, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1920, 1, 3, 12, 0, 0, 0, has_year_zero=True), ...,
       cftime.DatetimeNoLeap(2005, 12, 29, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2005, 12, 30, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2005, 12, 31, 12, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-399fdb13-04f8-4a2f-99ad-dda3f4daa562' class='xr-section-summary-in' type='checkbox'  ><label for='section-399fdb13-04f8-4a2f-99ad-dda3f4daa562' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4f291519-9874-4913-a718-22cd56f8e8eb' class='xr-index-data-in' type='checkbox'/><label for='index-4f291519-9874-4913-a718-22cd56f8e8eb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([            -90.0, -89.0575942993164, -88.1151809692383,
       -87.1727752685547, -86.2303695678711,  -85.287956237793,
       -84.3455505371094, -83.4031448364258, -82.4607315063477,
       -81.5183258056641,
       ...
        81.5183258056641,  82.4607315063477,  83.4031448364258,
        84.3455505371094,   85.287956237793,  86.2303695678711,
        87.1727752685547,  88.1151809692383,  89.0575942993164,
                    90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=192))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a82d3bd6-8d6c-4d4e-b91a-f39eafdd74b6' class='xr-index-data-in' type='checkbox'/><label for='index-a82d3bd6-8d6c-4d4e-b91a-f39eafdd74b6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,   1.25,    2.5,   3.75,    5.0,   6.25,    7.5,   8.75,   10.0,
        11.25,
       ...
        347.5, 348.75,  350.0, 351.25,  352.5, 353.75,  355.0, 356.25,  357.5,
       358.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=288))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>member_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1f99b89b-7768-40e4-adf6-d7c1e31b5e02' class='xr-index-data-in' type='checkbox'/><label for='index-1f99b89b-7768-40e4-adf6-d7c1e31b5e02' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,
        15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,
        29,  30,  31,  32,  33,  34,  35, 101, 102, 103, 104, 105],
      dtype=&#x27;int64&#x27;, name=&#x27;member_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6ef058f5-bb28-43fd-86c7-718ab66bbeb2' class='xr-index-data-in' type='checkbox'/><label for='index-6ef058f5-bb28-43fd-86c7-718ab66bbeb2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([1920-01-01 12:00:00, 1920-01-02 12:00:00, 1920-01-03 12:00:00,
             1920-01-04 12:00:00, 1920-01-05 12:00:00, 1920-01-06 12:00:00,
             1920-01-07 12:00:00, 1920-01-08 12:00:00, 1920-01-09 12:00:00,
             1920-01-10 12:00:00,
             ...
             2005-12-22 12:00:00, 2005-12-23 12:00:00, 2005-12-24 12:00:00,
             2005-12-25 12:00:00, 2005-12-26 12:00:00, 2005-12-27 12:00:00,
             2005-12-28 12:00:00, 2005-12-29 12:00:00, 2005-12-30 12:00:00,
             2005-12-31 12:00:00],
            dtype=&#x27;object&#x27;, length=31390, calendar=&#x27;noleap&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-082e41c5-9b1b-4789-9a11-59631d55989c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-082e41c5-9b1b-4789-9a11-59631d55989c' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>long_name :</span></dt><dd>Reference height temperature</dd><dt><span>units :</span></dt><dd>K</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The global surface temperature anomaly was computed relative to the 1961-90 base period in the Kay et al. paper, so extract that time slice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_ref</span> <span class="o">=</span> <span class="n">t_20c</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1961&quot;</span><span class="p">,</span> <span class="s2">&quot;1990&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="figure-2">
<h2>Figure 2<a class="headerlink" href="#figure-2" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<section id="read-grid-cell-areas">
<h3>Read grid cell areas<a class="headerlink" href="#read-grid-cell-areas" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Cell size varies with latitude, so this must be accounted for when computing the global mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;static&quot;</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="s2">&quot;atm&quot;</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;20C&quot;</span><span class="p">])</span>
<span class="n">_</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span><span class="n">aggregate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;anon&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">},</span> <span class="n">zarr_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;consolidated&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
<span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;variable.long_name.component.experiment.frequency.vertical_levels.spatial_domain.units.start_time.end_time.path&#39;
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:01&lt;00:00]
    </div>
    </div><div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 242kB
Dimensions:   (lat: 192, lon: 288, ilev: 31, lev: 30, bnds: 2, slat: 191,
               slon: 288)
Coordinates: (12/20)
    P0        float64 8B ...
    area      (lat, lon) float32 221kB dask.array&lt;chunksize=(192, 288), meta=np.ndarray&gt;
    gw        (lat) float64 2kB dask.array&lt;chunksize=(192,), meta=np.ndarray&gt;
    hyai      (ilev) float64 248B dask.array&lt;chunksize=(31,), meta=np.ndarray&gt;
    hyam      (lev) float64 240B dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;
    hybi      (ilev) float64 248B dask.array&lt;chunksize=(31,), meta=np.ndarray&gt;
    ...        ...
    ntrm      int32 4B ...
    ntrn      int32 4B ...
  * slat      (slat) float64 2kB -89.53 -88.59 -87.64 ... 87.64 88.59 89.53
  * slon      (slon) float64 2kB -0.625 0.625 1.875 3.125 ... 355.6 356.9 358.1
    w_stag    (slat) float64 2kB dask.array&lt;chunksize=(191,), meta=np.ndarray&gt;
    wnummax   (lat) int32 768B dask.array&lt;chunksize=(192,), meta=np.ndarray&gt;
Dimensions without coordinates: bnds
Data variables:
    *empty*
Attributes:
    intake_esm_vars:                  nan
    intake_esm_attrs:component:       atm
    intake_esm_attrs:experiment:      20C
    intake_esm_attrs:frequency:       static
    intake_esm_attrs:spatial_domain:  global
    intake_esm_attrs:path:            s3://ncar-cesm-lens/atm/static/grid.zarr
    intake_esm_attrs:_data_format_:   zarr
    intake_esm_dataset_key:           atm.20C.static.global.s3://ncar-cesm-le...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-165c49a5-7496-4b3f-ab1f-7645de733fc7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-165c49a5-7496-4b3f-ab1f-7645de733fc7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 288</li><li><span class='xr-has-index'>ilev</span>: 31</li><li><span class='xr-has-index'>lev</span>: 30</li><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>slat</span>: 191</li><li><span class='xr-has-index'>slon</span>: 288</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-125ec88d-2579-4acb-a485-9dbd992bf87d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-125ec88d-2579-4acb-a485-9dbd992bf87d' class='xr-section-summary' >Coordinates: <span>(20)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>P0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-80820906-99f7-4e3c-ae2e-f158b7581db7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-80820906-99f7-4e3c-ae2e-f158b7581db7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09dc8dfc-ecc6-44b2-9467-a11c503290dc' class='xr-var-data-in' type='checkbox'><label for='data-09dc8dfc-ecc6-44b2-9467-a11c503290dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference pressure</dd><dt><span>units :</span></dt><dd>Pa</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>area</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(192, 288), meta=np.ndarray&gt;</div><input id='attrs-bb7c639a-bdc0-4065-9669-debd64670c06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb7c639a-bdc0-4065-9669-debd64670c06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-550a93a0-1fc0-4d53-819a-c13625e6e76c' class='xr-var-data-in' type='checkbox'><label for='data-550a93a0-1fc0-4d53-819a-c13625e6e76c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Grid-Cell Area</dd><dt><span>standard_name :</span></dt><dd>cell_area</dd><dt><span>units :</span></dt><dd>m2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 216.00 kiB </td>
                        <td> 216.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (192, 288) </td>
                        <td> (192, 288) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="130" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="80" x2="120" y2="80" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="80" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="80" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,80.0 0.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="100.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="140.000000" y="40.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,40.000000)">192</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gw</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(192,), meta=np.ndarray&gt;</div><input id='attrs-158f9cc8-7007-42c9-9dac-d8a887617ca4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-158f9cc8-7007-42c9-9dac-d8a887617ca4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d7ceb1c-6488-438a-a4df-abacdc6c0b1f' class='xr-var-data-in' type='checkbox'><label for='data-7d7ceb1c-6488-438a-a4df-abacdc6c0b1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>gauss weights</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.50 kiB </td>
                        <td> 1.50 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (192,) </td>
                        <td> (192,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >192</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hyai</span></div><div class='xr-var-dims'>(ilev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31,), meta=np.ndarray&gt;</div><input id='attrs-f785504f-302d-46ff-a181-d84f96469b03' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f785504f-302d-46ff-a181-d84f96469b03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7074faa4-c594-4fea-9fd7-1cb7430cb28c' class='xr-var-data-in' type='checkbox'><label for='data-7074faa4-c594-4fea-9fd7-1cb7430cb28c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid A coefficient at layer interfaces</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 248 B </td>
                        <td> 248 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31,) </td>
                        <td> (31,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="81" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="31" x2="120" y2="31" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="31" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="31" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,31.82636012251828 0.0,31.82636012251828" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="51.826360" font-size="1.0rem" font-weight="100" text-anchor="middle" >31</text>
  <text x="140.000000" y="15.913180" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,15.913180)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hyam</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;</div><input id='attrs-6c0d373b-a692-4d37-9d4c-4c7552a26964' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c0d373b-a692-4d37-9d4c-4c7552a26964' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11c306d5-bd7d-4581-87c4-4514b6c70c79' class='xr-var-data-in' type='checkbox'><label for='data-11c306d5-bd7d-4581-87c4-4514b6c70c79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid A coefficient at layer midpoints</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 240 B </td>
                        <td> 240 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (30,) </td>
                        <td> (30,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="82" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="32" x2="120" y2="32" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="32" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="32" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,32.02435249410096 0.0,32.02435249410096" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="52.024352" font-size="1.0rem" font-weight="100" text-anchor="middle" >30</text>
  <text x="140.000000" y="16.012176" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,16.012176)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hybi</span></div><div class='xr-var-dims'>(ilev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(31,), meta=np.ndarray&gt;</div><input id='attrs-df7c624c-0ad9-4334-9261-eeba1c2258da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-df7c624c-0ad9-4334-9261-eeba1c2258da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0aac715-6a59-48ec-811b-34b47fa34995' class='xr-var-data-in' type='checkbox'><label for='data-b0aac715-6a59-48ec-811b-34b47fa34995' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid B coefficient at layer interfaces</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 248 B </td>
                        <td> 248 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31,) </td>
                        <td> (31,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="81" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="31" x2="120" y2="31" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="31" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="31" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,31.82636012251828 0.0,31.82636012251828" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="51.826360" font-size="1.0rem" font-weight="100" text-anchor="middle" >31</text>
  <text x="140.000000" y="15.913180" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,15.913180)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hybm</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;</div><input id='attrs-3359e080-4d6e-4205-8657-d27be6e24c25' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3359e080-4d6e-4205-8657-d27be6e24c25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-197c11d6-0c78-4150-995b-99241f04777e' class='xr-var-data-in' type='checkbox'><label for='data-197c11d6-0c78-4150-995b-99241f04777e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid B coefficient at layer midpoints</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 240 B </td>
                        <td> 240 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (30,) </td>
                        <td> (30,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="82" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="32" x2="120" y2="32" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="32" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="32" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,32.02435249410096 0.0,32.02435249410096" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="52.024352" font-size="1.0rem" font-weight="100" text-anchor="middle" >30</text>
  <text x="140.000000" y="16.012176" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,16.012176)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>ilev</span></div><div class='xr-var-dims'>(ilev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.255 5.032 10.16 ... 985.1 1e+03</div><input id='attrs-1254451c-cf69-4692-96fe-391447110fec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1254451c-cf69-4692-96fe-391447110fec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1a06059-b00d-4ae6-8bfa-760ed444f3ff' class='xr-var-data-in' type='checkbox'><label for='data-a1a06059-b00d-4ae6-8bfa-760ed444f3ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>formula_terms :</span></dt><dd>a: hyai b: hybi p0: P0 ps: PS</dd><dt><span>long_name :</span></dt><dd>hybrid level at interfaces (1000*(A+B))</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array([   2.25524 ,    5.031692,   10.157947,   18.555317,   30.669123,
         45.867477,   63.323483,   80.701418,   94.941042,  111.693211,
        131.401271,  154.586807,  181.863353,  213.952821,  251.704417,
        296.117216,  348.366588,  409.835219,  482.149929,  567.224421,
        652.332969,  730.445892,  796.363071,  845.353667,  873.715866,
        900.324631,  924.964462,  947.432335,  967.538625,  985.11219 ,
       1000.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.06 -88.12 ... 89.06 90.0</div><input id='attrs-987413cf-28d9-4239-a9f4-1329da2e30b8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-987413cf-28d9-4239-a9f4-1329da2e30b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-46ae14bb-8a1d-44fd-9a95-1b0cbf95a449' class='xr-var-data-in' type='checkbox'><label for='data-46ae14bb-8a1d-44fd-9a95-1b0cbf95a449' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.057594, -88.115181, -87.172775, -86.23037 , -85.287956,
       -84.345551, -83.403145, -82.460732, -81.518326, -80.575912, -79.633507,
       -78.691101, -77.748688, -76.806282, -75.863876, -74.921463, -73.979057,
       -73.036652, -72.094238, -71.151833, -70.209427, -69.267014, -68.324608,
       -67.382202, -66.439789, -65.497383, -64.554977, -63.612564, -62.670158,
       -61.727749, -60.785339, -59.842934, -58.900524, -57.958115, -57.015705,
       -56.073299, -55.13089 , -54.18848 , -53.246075, -52.303665, -51.361256,
       -50.41885 , -49.47644 , -48.534031, -47.591621, -46.649216, -45.706806,
       -44.764397, -43.821991, -42.879581, -41.937172, -40.994766, -40.052357,
       -39.109947, -38.167538, -37.225132, -36.282722, -35.340313, -34.397907,
       -33.455498, -32.513088, -31.570681, -30.628273, -29.685863, -28.743456,
       -27.801046, -26.858639, -25.916231, -24.973822, -24.031414, -23.089005,
       -22.146597, -21.204189, -20.26178 , -19.319372, -18.376963, -17.434555,
       -16.492147, -15.549738, -14.607329, -13.664922, -12.722513, -11.780105,
       -10.837696,  -9.895288,  -8.95288 ,  -8.010471,  -7.068063,  -6.125654,
        -5.183246,  -4.240838,  -3.298429,  -2.356021,  -1.413613,  -0.471204,
         0.471204,   1.413613,   2.356021,   3.298429,   4.240838,   5.183246,
         6.125654,   7.068063,   8.010471,   8.95288 ,   9.895288,  10.837696,
        11.780105,  12.722513,  13.664922,  14.607329,  15.549738,  16.492147,
        17.434555,  18.376963,  19.319372,  20.26178 ,  21.204189,  22.146597,
        23.089005,  24.031414,  24.973822,  25.916231,  26.858639,  27.801046,
        28.743456,  29.685863,  30.628273,  31.570681,  32.513088,  33.455498,
        34.397907,  35.340313,  36.282722,  37.225132,  38.167538,  39.109947,
        40.052357,  40.994766,  41.937172,  42.879581,  43.821991,  44.764397,
        45.706806,  46.649216,  47.591621,  48.534031,  49.47644 ,  50.41885 ,
        51.361256,  52.303665,  53.246075,  54.18848 ,  55.13089 ,  56.073299,
        57.015705,  57.958115,  58.900524,  59.842934,  60.785339,  61.727749,
        62.670158,  63.612564,  64.554977,  65.497383,  66.439789,  67.382202,
        68.324608,  69.267014,  70.209427,  71.151833,  72.094238,  73.036652,
        73.979057,  74.921463,  75.863876,  76.806282,  77.748688,  78.691101,
        79.633507,  80.575912,  81.518326,  82.460732,  83.403145,  84.345551,
        85.287956,  86.23037 ,  87.172775,  88.115181,  89.057594,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(lat, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(192, 2), meta=np.ndarray&gt;</div><input id='attrs-687fe5ba-a12a-419f-9deb-efa82222a2dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-687fe5ba-a12a-419f-9deb-efa82222a2dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4243d86e-82c8-42ce-9a1e-71c60990e6c7' class='xr-var-data-in' type='checkbox'><label for='data-4243d86e-82c8-42ce-9a1e-71c60990e6c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.00 kiB </td>
                        <td> 3.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (192, 2) </td>
                        <td> (192, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.60913412115106,0.0 25.60913412115106,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.804567" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.609134" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.609134,60.000000)">192</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.643 7.595 14.36 ... 976.3 992.6</div><input id='attrs-05a54763-bbf1-4a11-9286-a2fc729c8359' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-05a54763-bbf1-4a11-9286-a2fc729c8359' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bf00c3a-f5e0-4fc4-86ef-25723fef46cb' class='xr-var-data-in' type='checkbox'><label for='data-4bf00c3a-f5e0-4fc4-86ef-25723fef46cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>formula_terms :</span></dt><dd>a: hyam b: hybm p0: P0 ps: PS</dd><dt><span>long_name :</span></dt><dd>hybrid level at midpoints (1000*(A+B))</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array([  3.643466,   7.59482 ,  14.356632,  24.61222 ,  38.2683  ,  54.59548 ,
        72.012451,  87.82123 , 103.317127, 121.547241, 142.994039, 168.22508 ,
       197.908087, 232.828619, 273.910817, 322.241902, 379.100904, 445.992574,
       524.687175, 609.778695, 691.38943 , 763.404481, 820.858369, 859.534767,
       887.020249, 912.644547, 936.198398, 957.48548 , 976.325407, 992.556095])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.25 2.5 ... 356.2 357.5 358.8</div><input id='attrs-c8e8276c-e050-4887-b562-88e916ce9405' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8e8276c-e050-4887-b562-88e916ce9405' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7c2ca7a-26d1-4e24-91f4-4c8cacf798db' class='xr-var-data-in' type='checkbox'><label for='data-a7c2ca7a-26d1-4e24-91f4-4c8cacf798db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0.  ,   1.25,   2.5 , ..., 356.25, 357.5 , 358.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(lon, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(288, 2), meta=np.ndarray&gt;</div><input id='attrs-620a0169-5716-47e9-8ca5-af72b209debf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-620a0169-5716-47e9-8ca5-af72b209debf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c625b87f-8eb4-43f3-ae11-028ff4d68e5c' class='xr-var-data-in' type='checkbox'><label for='data-c625b87f-8eb4-43f3-ae11-028ff4d68e5c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.50 kiB </td>
                        <td> 4.50 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (288, 2) </td>
                        <td> (288, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">288</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrk</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bd1e7d07-b71a-4c99-bfbf-578225669533' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd1e7d07-b71a-4c99-bfbf-578225669533' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f079c0af-a407-4cb1-b383-fabad48b6710' class='xr-var-data-in' type='checkbox'><label for='data-f079c0af-a407-4cb1-b383-fabad48b6710' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter K</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrm</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-11c7bea3-bd09-4e4f-8e4b-06cf8824a1bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-11c7bea3-bd09-4e4f-8e4b-06cf8824a1bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8270e368-dfa5-4e8d-90a6-cb1b22640cac' class='xr-var-data-in' type='checkbox'><label for='data-8270e368-dfa5-4e8d-90a6-cb1b22640cac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter M</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrn</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-dc898aa3-98de-4944-a127-a1d177e41ad9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc898aa3-98de-4944-a127-a1d177e41ad9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c9b9a46-f1b0-4e64-b106-665c8c1610a9' class='xr-var-data-in' type='checkbox'><label for='data-1c9b9a46-f1b0-4e64-b106-665c8c1610a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter N</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>slat</span></div><div class='xr-var-dims'>(slat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.53 -88.59 ... 88.59 89.53</div><input id='attrs-11aacd89-adaf-494f-b21a-b4d07499e8f9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-11aacd89-adaf-494f-b21a-b4d07499e8f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd124799-6833-45ad-9b29-f243fce1f72d' class='xr-var-data-in' type='checkbox'><label for='data-cd124799-6833-45ad-9b29-f243fce1f72d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>staggered latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89.528796, -88.586387, -87.643979, -86.701571, -85.759162, -84.816754,
       -83.874346, -82.931937, -81.989529, -81.04712 , -80.104712, -79.162304,
       -78.219895, -77.277487, -76.335079, -75.39267 , -74.450262, -73.507853,
       -72.565445, -71.623037, -70.680628, -69.73822 , -68.795812, -67.853403,
       -66.910995, -65.968586, -65.026178, -64.08377 , -63.141361, -62.198953,
       -61.256545, -60.314136, -59.371728, -58.429319, -57.486911, -56.544503,
       -55.602094, -54.659686, -53.717277, -52.774869, -51.832461, -50.890052,
       -49.947644, -49.005236, -48.062827, -47.120419, -46.17801 , -45.235602,
       -44.293194, -43.350785, -42.408377, -41.465969, -40.52356 , -39.581152,
       -38.638743, -37.696335, -36.753927, -35.811518, -34.86911 , -33.926702,
       -32.984293, -32.041885, -31.099476, -30.157068, -29.21466 , -28.272251,
       -27.329843, -26.387435, -25.445026, -24.502618, -23.560209, -22.617801,
       -21.675393, -20.732984, -19.790576, -18.848168, -17.905759, -16.963351,
       -16.020942, -15.078534, -14.136126, -13.193717, -12.251309, -11.308901,
       -10.366492,  -9.424084,  -8.481675,  -7.539267,  -6.596859,  -5.65445 ,
        -4.712042,  -3.769634,  -2.827225,  -1.884817,  -0.942408,   0.      ,
         0.942408,   1.884817,   2.827225,   3.769634,   4.712042,   5.65445 ,
         6.596859,   7.539267,   8.481675,   9.424084,  10.366492,  11.308901,
        12.251309,  13.193717,  14.136126,  15.078534,  16.020942,  16.963351,
        17.905759,  18.848168,  19.790576,  20.732984,  21.675393,  22.617801,
        23.560209,  24.502618,  25.445026,  26.387435,  27.329843,  28.272251,
        29.21466 ,  30.157068,  31.099476,  32.041885,  32.984293,  33.926702,
        34.86911 ,  35.811518,  36.753927,  37.696335,  38.638743,  39.581152,
        40.52356 ,  41.465969,  42.408377,  43.350785,  44.293194,  45.235602,
        46.17801 ,  47.120419,  48.062827,  49.005236,  49.947644,  50.890052,
        51.832461,  52.774869,  53.717277,  54.659686,  55.602094,  56.544503,
        57.486911,  58.429319,  59.371728,  60.314136,  61.256545,  62.198953,
        63.141361,  64.08377 ,  65.026178,  65.968586,  66.910995,  67.853403,
        68.795812,  69.73822 ,  70.680628,  71.623037,  72.565445,  73.507853,
        74.450262,  75.39267 ,  76.335079,  77.277487,  78.219895,  79.162304,
        80.104712,  81.04712 ,  81.989529,  82.931937,  83.874346,  84.816754,
        85.759162,  86.701571,  87.643979,  88.586387,  89.528796])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>slon</span></div><div class='xr-var-dims'>(slon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.625 0.625 1.875 ... 356.9 358.1</div><input id='attrs-cee6fa3e-3aeb-494e-9c6b-cb5c8b05e583' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cee6fa3e-3aeb-494e-9c6b-cb5c8b05e583' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d42c671-7554-4873-b4c3-18f9421fffb1' class='xr-var-data-in' type='checkbox'><label for='data-8d42c671-7554-4873-b4c3-18f9421fffb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>staggered longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([ -0.625,   0.625,   1.875, ..., 355.625, 356.875, 358.125])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>w_stag</span></div><div class='xr-var-dims'>(slat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(191,), meta=np.ndarray&gt;</div><input id='attrs-306b15d9-fa38-40e4-87a2-503457bda638' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-306b15d9-fa38-40e4-87a2-503457bda638' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc5391c6-67a9-47f4-aca4-e8a2746620fb' class='xr-var-data-in' type='checkbox'><label for='data-bc5391c6-67a9-47f4-aca4-e8a2746620fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>staggered latitude weights</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.49 kiB </td>
                        <td> 1.49 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (191,) </td>
                        <td> (191,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >191</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wnummax</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(192,), meta=np.ndarray&gt;</div><input id='attrs-4f6c2a96-d987-463f-b180-6c8743bdfe2e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f6c2a96-d987-463f-b180-6c8743bdfe2e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d20a3b51-11b1-41bd-b3a1-40617c76f9b6' class='xr-var-data-in' type='checkbox'><label for='data-d20a3b51-11b1-41bd-b3a1-40617c76f9b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>cutoff Fourier wavenumber</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 768 B </td>
                        <td> 768 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (192,) </td>
                        <td> (192,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >192</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ee0995bc-5daa-4a1c-8c9f-b50a5fba9e6f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ee0995bc-5daa-4a1c-8c9f-b50a5fba9e6f' class='xr-section-summary'  title='Expand/collapse section'>Data variables: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-c9378b43-c990-49ab-b247-4ae97587705f' class='xr-section-summary-in' type='checkbox'  ><label for='section-c9378b43-c990-49ab-b247-4ae97587705f' class='xr-section-summary' >Indexes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>ilev</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6e66c599-b894-4e76-8d63-45c75af1828f' class='xr-index-data-in' type='checkbox'/><label for='index-6e66c599-b894-4e76-8d63-45c75af1828f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 2.255239523947239,  5.031691864132881,  10.15794742852449,
        18.55531707406044,  30.66912293434143,  45.86747661232948,
         63.3234828710556,  80.70141822099686,  94.94104236364365,
       111.69321089982991,  131.4012706279755,  154.5868068933487,
        181.8633526563644, 213.95282074809072, 251.70441716909409,
       296.11721634864807,  348.3665883541107,  409.8352193832398,
       482.14992880821234,    567.22442060709,  652.3329690098763,
        730.4458916187286,  796.3630706071854,  845.3536666929722,
        873.7158663570881,  900.3246314823627,  924.9644624069333,
        947.4323345348239,  967.5386245362461,   985.112190246582,
                   1000.0],
      dtype=&#x27;float64&#x27;, name=&#x27;ilev&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d6dca78d-5eb1-4c56-9137-01b029127aa1' class='xr-index-data-in' type='checkbox'/><label for='index-d6dca78d-5eb1-4c56-9137-01b029127aa1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([            -90.0, -89.0575942993164, -88.1151809692383,
       -87.1727752685547, -86.2303695678711,  -85.287956237793,
       -84.3455505371094, -83.4031448364258, -82.4607315063477,
       -81.5183258056641,
       ...
        81.5183258056641,  82.4607315063477,  83.4031448364258,
        84.3455505371094,   85.287956237793,  86.2303695678711,
        87.1727752685547,  88.1151809692383,  89.0575942993164,
                    90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=192))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1556e9ee-e190-4f0d-9052-6f94fc73c17d' class='xr-index-data-in' type='checkbox'/><label for='index-1556e9ee-e190-4f0d-9052-6f94fc73c17d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  3.64346569404006,  7.594819646328688, 14.356632251292467,
       24.612220004200935,  38.26829977333546,  54.59547974169254,
        72.01245054602623,  87.82123029232025, 103.31712663173676,
       121.54724076390266, 142.99403876066208, 168.22507977485657,
        197.9080867022276, 232.82861895859241,  273.9108167588711,
        322.2419023513794, 379.10090386867523,   445.992574095726,
        524.6871747076511,  609.7786948084831,  691.3894303143024,
         763.404481112957,  820.8583686500788,  859.5347665250301,
        887.0202489197254,   912.644546944648,  936.1983984708786,
         957.485479535535,   976.325407391414,   992.556095123291],
      dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-670d1c9c-4f14-4751-87c6-f9de82cb0ff0' class='xr-index-data-in' type='checkbox'/><label for='index-670d1c9c-4f14-4751-87c6-f9de82cb0ff0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,   1.25,    2.5,   3.75,    5.0,   6.25,    7.5,   8.75,   10.0,
        11.25,
       ...
        347.5, 348.75,  350.0, 351.25,  352.5, 353.75,  355.0, 356.25,  357.5,
       358.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=288))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>slat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4d9ae7f7-ad9f-4de0-a8c9-414eaaa942b4' class='xr-index-data-in' type='checkbox'/><label for='index-4d9ae7f7-ad9f-4de0-a8c9-414eaaa942b4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.52879581151834, -88.58638743455496, -87.64397905759164,
       -86.70157068062828, -85.75916230366491, -84.81675392670158,
       -83.87434554973822, -82.93193717277487, -81.98952879581152,
       -81.04712041884817,
       ...
        81.04712041884817,  81.98952879581152,  82.93193717277487,
        83.87434554973822,  84.81675392670155,  85.75916230366491,
         86.7015706806283,  87.64397905759164,  88.58638743455496,
        89.52879581151834],
      dtype=&#x27;float64&#x27;, name=&#x27;slat&#x27;, length=191))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>slon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-585f281a-644f-40e3-b535-8f94e40e2e49' class='xr-index-data-in' type='checkbox'/><label for='index-585f281a-644f-40e3-b535-8f94e40e2e49' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -0.625,   0.625,   1.875,   3.125,   4.375,   5.625,   6.875,   8.125,
         9.375,  10.625,
       ...
       346.875, 348.125, 349.375, 350.625, 351.875, 353.125, 354.375, 355.625,
       356.875, 358.125],
      dtype=&#x27;float64&#x27;, name=&#x27;slon&#x27;, length=288))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cb9466e3-d6b4-4803-a5a8-07213314b2fc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cb9466e3-d6b4-4803-a5a8-07213314b2fc' class='xr-section-summary' >Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>intake_esm_vars :</span></dt><dd>nan</dd><dt><span>intake_esm_attrs:component :</span></dt><dd>atm</dd><dt><span>intake_esm_attrs:experiment :</span></dt><dd>20C</dd><dt><span>intake_esm_attrs:frequency :</span></dt><dd>static</dd><dt><span>intake_esm_attrs:spatial_domain :</span></dt><dd>global</dd><dt><span>intake_esm_attrs:path :</span></dt><dd>s3://ncar-cesm-lens/atm/static/grid.zarr</dd><dt><span>intake_esm_attrs:_data_format_ :</span></dt><dd>zarr</dd><dt><span>intake_esm_dataset_key :</span></dt><dd>atm.20C.static.global.s3://ncar-cesm-lens/atm/static/grid.zarr</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_area</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">area</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">total_area</span> <span class="o">=</span> <span class="n">cell_area</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">cell_area</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;area&#x27; (lat: 192, lon: 288)&gt; Size: 221kB
array([[2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       ...,
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07]], dtype=float32)
Coordinates:
    P0       float64 8B 1e+05
    area     (lat, lon) float32 221kB 2.995e+07 2.995e+07 ... 2.995e+07
    gw       (lat) float64 2kB 3.382e-05 nan nan nan ... nan nan nan 3.382e-05
  * lat      (lat) float64 2kB -90.0 -89.06 -88.12 -87.17 ... 88.12 89.06 90.0
  * lon      (lon) float64 2kB 0.0 1.25 2.5 3.75 5.0 ... 355.0 356.2 357.5 358.8
    ntrk     int32 4B 1
    ntrm     int32 4B 1
    ntrn     int32 4B 1
    wnummax  (lat) int32 768B 1 -2147483648 -2147483648 ... -2147483648 1
Attributes:
    long_name:      Grid-Cell Area
    standard_name:  cell_area
    units:          m2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'area'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 288</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-28a6fbe6-838b-48a9-bc9d-2abe77c30533' class='xr-array-in' type='checkbox' checked><label for='section-28a6fbe6-838b-48a9-bc9d-2abe77c30533' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2.995e+07 2.995e+07 2.995e+07 ... 2.995e+07 2.995e+07 2.995e+07</span></div><div class='xr-array-data'><pre>array([[2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       ...,
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-ba6a7483-e1ab-4abb-8d71-bbbd41939792' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ba6a7483-e1ab-4abb-8d71-bbbd41939792' class='xr-section-summary' >Coordinates: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>P0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+05</div><input id='attrs-f5164e99-dd0f-4cb8-b011-360864770343' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5164e99-dd0f-4cb8-b011-360864770343' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18318815-6a91-4a67-a4ad-e6034118e8b0' class='xr-var-data-in' type='checkbox'><label for='data-18318815-6a91-4a67-a4ad-e6034118e8b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference pressure</dd><dt><span>units :</span></dt><dd>Pa</dd></dl></div><div class='xr-var-data'><pre>array(100000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>area</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.995e+07 2.995e+07 ... 2.995e+07</div><input id='attrs-749c192e-e1f8-43eb-8ab7-c8de2b6992dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-749c192e-e1f8-43eb-8ab7-c8de2b6992dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bbdaf193-8ca6-4ca1-9488-227bd254152f' class='xr-var-data-in' type='checkbox'><label for='data-bbdaf193-8ca6-4ca1-9488-227bd254152f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Grid-Cell Area</dd><dt><span>standard_name :</span></dt><dd>cell_area</dd><dt><span>units :</span></dt><dd>m2</dd></dl></div><div class='xr-var-data'><pre>array([[2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       ...,
       [4.790848e+08, 4.790848e+08, 4.790848e+08, ..., 4.790848e+08,
        4.790848e+08, 4.790848e+08],
       [2.395748e+08, 2.395748e+08, 2.395748e+08, ..., 2.395748e+08,
        2.395748e+08, 2.395748e+08],
       [2.994837e+07, 2.994837e+07, 2.994837e+07, ..., 2.994837e+07,
        2.994837e+07, 2.994837e+07]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gw</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.382e-05 nan nan ... nan 3.382e-05</div><input id='attrs-970e08fa-febe-4aba-962d-7aecc862091c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-970e08fa-febe-4aba-962d-7aecc862091c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-039680cf-02d5-410f-9e24-4cc1dde8dadd' class='xr-var-data-in' type='checkbox'><label for='data-039680cf-02d5-410f-9e24-4cc1dde8dadd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>gauss weights</dd></dl></div><div class='xr-var-data'><pre>array([3.38174282e-05,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
...
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan,            nan,
                  nan,            nan,            nan, 3.38174282e-05])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.06 -88.12 ... 89.06 90.0</div><input id='attrs-7a23bb90-4b7d-4e4e-b739-1e7a94148c2f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a23bb90-4b7d-4e4e-b739-1e7a94148c2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9e56bc6-9c93-4aba-afcc-e96fe983f887' class='xr-var-data-in' type='checkbox'><label for='data-a9e56bc6-9c93-4aba-afcc-e96fe983f887' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.057594, -88.115181, -87.172775, -86.23037 , -85.287956,
       -84.345551, -83.403145, -82.460732, -81.518326, -80.575912, -79.633507,
       -78.691101, -77.748688, -76.806282, -75.863876, -74.921463, -73.979057,
       -73.036652, -72.094238, -71.151833, -70.209427, -69.267014, -68.324608,
       -67.382202, -66.439789, -65.497383, -64.554977, -63.612564, -62.670158,
       -61.727749, -60.785339, -59.842934, -58.900524, -57.958115, -57.015705,
       -56.073299, -55.13089 , -54.18848 , -53.246075, -52.303665, -51.361256,
       -50.41885 , -49.47644 , -48.534031, -47.591621, -46.649216, -45.706806,
       -44.764397, -43.821991, -42.879581, -41.937172, -40.994766, -40.052357,
       -39.109947, -38.167538, -37.225132, -36.282722, -35.340313, -34.397907,
       -33.455498, -32.513088, -31.570681, -30.628273, -29.685863, -28.743456,
       -27.801046, -26.858639, -25.916231, -24.973822, -24.031414, -23.089005,
       -22.146597, -21.204189, -20.26178 , -19.319372, -18.376963, -17.434555,
       -16.492147, -15.549738, -14.607329, -13.664922, -12.722513, -11.780105,
       -10.837696,  -9.895288,  -8.95288 ,  -8.010471,  -7.068063,  -6.125654,
        -5.183246,  -4.240838,  -3.298429,  -2.356021,  -1.413613,  -0.471204,
         0.471204,   1.413613,   2.356021,   3.298429,   4.240838,   5.183246,
         6.125654,   7.068063,   8.010471,   8.95288 ,   9.895288,  10.837696,
        11.780105,  12.722513,  13.664922,  14.607329,  15.549738,  16.492147,
        17.434555,  18.376963,  19.319372,  20.26178 ,  21.204189,  22.146597,
        23.089005,  24.031414,  24.973822,  25.916231,  26.858639,  27.801046,
        28.743456,  29.685863,  30.628273,  31.570681,  32.513088,  33.455498,
        34.397907,  35.340313,  36.282722,  37.225132,  38.167538,  39.109947,
        40.052357,  40.994766,  41.937172,  42.879581,  43.821991,  44.764397,
        45.706806,  46.649216,  47.591621,  48.534031,  49.47644 ,  50.41885 ,
        51.361256,  52.303665,  53.246075,  54.18848 ,  55.13089 ,  56.073299,
        57.015705,  57.958115,  58.900524,  59.842934,  60.785339,  61.727749,
        62.670158,  63.612564,  64.554977,  65.497383,  66.439789,  67.382202,
        68.324608,  69.267014,  70.209427,  71.151833,  72.094238,  73.036652,
        73.979057,  74.921463,  75.863876,  76.806282,  77.748688,  78.691101,
        79.633507,  80.575912,  81.518326,  82.460732,  83.403145,  84.345551,
        85.287956,  86.23037 ,  87.172775,  88.115181,  89.057594,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.25 2.5 ... 356.2 357.5 358.8</div><input id='attrs-4460a35e-1be4-4681-b7c0-d106cf986659' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4460a35e-1be4-4681-b7c0-d106cf986659' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-094cc2d1-fa19-4c82-a8bb-b2fc1c5a963e' class='xr-var-data-in' type='checkbox'><label for='data-094cc2d1-fa19-4c82-a8bb-b2fc1c5a963e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0.  ,   1.25,   2.5 , ..., 356.25, 357.5 , 358.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrk</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-da585bbc-0cfd-4765-b81f-0650a921b89c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-da585bbc-0cfd-4765-b81f-0650a921b89c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d072a76f-88a3-4203-b9a4-d1439422ad38' class='xr-var-data-in' type='checkbox'><label for='data-d072a76f-88a3-4203-b9a4-d1439422ad38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter K</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrm</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-aaedc81e-c7f2-4889-bb26-73edcde12c44' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aaedc81e-c7f2-4889-bb26-73edcde12c44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61032e56-80c7-4cb6-b7f2-84c9d00fb7fc' class='xr-var-data-in' type='checkbox'><label for='data-61032e56-80c7-4cb6-b7f2-84c9d00fb7fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter M</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrn</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-11a6164f-69f0-46f2-a45d-164d0dca80f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-11a6164f-69f0-46f2-a45d-164d0dca80f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a14af884-bd0d-4a8f-9e24-a95af59e274d' class='xr-var-data-in' type='checkbox'><label for='data-a14af884-bd0d-4a8f-9e24-a95af59e274d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter N</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wnummax</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 -2147483648 ... -2147483648 1</div><input id='attrs-a83613b9-a0ab-4ced-b851-8436b5d84cc9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a83613b9-a0ab-4ced-b851-8436b5d84cc9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5095420d-857e-4ccc-89a4-cf5a70e97a01' class='xr-var-data-in' type='checkbox'><label for='data-5095420d-857e-4ccc-89a4-cf5a70e97a01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>cutoff Fourier wavenumber</dd></dl></div><div class='xr-var-data'><pre>array([          1, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648, -2147483648, -2147483648, -2147483648, -2147483648,
       -2147483648,           1], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1b589120-f93d-45a7-be0a-feb758ec7a9b' class='xr-section-summary-in' type='checkbox'  ><label for='section-1b589120-f93d-45a7-be0a-feb758ec7a9b' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1fc5b65b-5cfa-42de-aba2-c9633c8b51bb' class='xr-index-data-in' type='checkbox'/><label for='index-1fc5b65b-5cfa-42de-aba2-c9633c8b51bb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([            -90.0, -89.0575942993164, -88.1151809692383,
       -87.1727752685547, -86.2303695678711,  -85.287956237793,
       -84.3455505371094, -83.4031448364258, -82.4607315063477,
       -81.5183258056641,
       ...
        81.5183258056641,  82.4607315063477,  83.4031448364258,
        84.3455505371094,   85.287956237793,  86.2303695678711,
        87.1727752685547,  88.1151809692383,  89.0575942993164,
                    90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=192))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3996074c-9349-48b1-8e6c-5373342caf93' class='xr-index-data-in' type='checkbox'/><label for='index-3996074c-9349-48b1-8e6c-5373342caf93' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,   1.25,    2.5,   3.75,    5.0,   6.25,    7.5,   8.75,   10.0,
        11.25,
       ...
        347.5, 348.75,  350.0, 351.25,  352.5, 353.75,  355.0, 356.25,  357.5,
       358.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=288))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1e51dc7e-0193-42ec-8baf-733e10b77dd0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1e51dc7e-0193-42ec-8baf-733e10b77dd0' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Grid-Cell Area</dd><dt><span>standard_name :</span></dt><dd>cell_area</dd><dt><span>units :</span></dt><dd>m2</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="define-weighted-means">
<h3>Define weighted means<a class="headerlink" href="#define-weighted-means" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Note: <code class="docutils literal notranslate"><span class="pre">resample(time=&quot;AS&quot;)</span></code> does an annual resampling based on start of calendar year. See documentation for <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">Pandas resampling options</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_ref_ts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">t_ref</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
    <span class="o">/</span> <span class="n">total_area</span>
<span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;member_id&quot;</span><span class="p">))</span>

<span class="n">t_hist_ts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">t_hist</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">total_area</span>

<span class="n">t_20c_ts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">t_20c</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">total_area</span>

<span class="n">t_rcp_ts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">t_rcp</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">total_area</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-data-and-compute-means">
<h3>Read data and compute means<a class="headerlink" href="#read-data-and-compute-means" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Dask’s “lazy execution” philosophy means that until this point we have not actually read the bulk of the data. Steps 1, 3, and 4 take a while to complete, so we include the Notebook “cell magic” directive <code class="docutils literal notranslate"><span class="pre">%%time</span></code> to display elapsed and CPU times after computation.</p>
<p>Step 1 (takes a while)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># this cell takes a while, be patient</span>
<span class="n">t_ref_mean</span> <span class="o">=</span> <span class="n">t_ref_ts</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">t_ref_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 27.1 s, sys: 5.68 s, total: 32.8 s
Wall time: 8min 14s
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt; Size: 4B
array(286.38763, dtype=float32)
Coordinates:
    P0       float64 8B 1e+05
    ntrk     int32 4B 1
    ntrm     int32 4B 1
    ntrn     int32 4B 1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-19a463c8-41f4-420d-b95b-6fefe17a01e1' class='xr-array-in' type='checkbox' checked><label for='section-19a463c8-41f4-420d-b95b-6fefe17a01e1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>286.4</span></div><div class='xr-array-data'><pre>array(286.38763, dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-1ebb4e0e-9f89-4511-83a0-1fbfaf85ffeb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ebb4e0e-9f89-4511-83a0-1fbfaf85ffeb' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>P0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+05</div><input id='attrs-f5a08d99-b90e-4c1a-a815-9056c733b141' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5a08d99-b90e-4c1a-a815-9056c733b141' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7537d30f-d272-4780-88fc-b2ecb26991cd' class='xr-var-data-in' type='checkbox'><label for='data-7537d30f-d272-4780-88fc-b2ecb26991cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference pressure</dd><dt><span>units :</span></dt><dd>Pa</dd></dl></div><div class='xr-var-data'><pre>array(100000.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrk</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-26301765-4a52-42be-9427-78fe57a454b2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26301765-4a52-42be-9427-78fe57a454b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20e21950-f7ac-44b3-a090-1026e251f06f' class='xr-var-data-in' type='checkbox'><label for='data-20e21950-f7ac-44b3-a090-1026e251f06f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter K</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrm</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-92cda146-2cba-4151-98c4-b56f96e60394' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92cda146-2cba-4151-98c4-b56f96e60394' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cba1df2-963c-44e5-8584-4f80d2156e91' class='xr-var-data-in' type='checkbox'><label for='data-7cba1df2-963c-44e5-8584-4f80d2156e91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter M</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ntrn</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-406b07af-606e-413d-80d4-26bc8d31a66c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-406b07af-606e-413d-80d4-26bc8d31a66c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d90d5402-c1a0-4de3-be48-e25a57a86072' class='xr-var-data-in' type='checkbox'><label for='data-d90d5402-c1a0-4de3-be48-e25a57a86072' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>spectral truncation parameter N</dd></dl></div><div class='xr-var-data'><pre>array(1, dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b8d0399a-ceab-4092-b4ff-51ebd9ac530e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b8d0399a-ceab-4092-b4ff-51ebd9ac530e' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-2c878cc2-dc1b-4a76-b55d-250e43877970' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2c878cc2-dc1b-4a76-b55d-250e43877970' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Step 2 (executes quickly)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span> 
<span class="n">t_hist_ts_df</span> <span class="o">=</span> <span class="n">t_hist_ts</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#t_hist_ts_df.head()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 447 ms, sys: 36.4 ms, total: 483 ms
Wall time: 2.73 s
</pre></div>
</div>
</div>
</div>
<p>Step 3 (takes even longer than Step 1)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">t_20c_ts_df</span> <span class="o">=</span> <span class="n">t_20c_ts</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">t_20c_ts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 6s, sys: 14 s, total: 1min 20s
Wall time: 20min 39s
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>member_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>101</th>
      <th>102</th>
      <th>103</th>
      <th>104</th>
      <th>105</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1920-01-01 00:00:00</th>
      <td>286.311310</td>
      <td>286.346710</td>
      <td>286.283875</td>
      <td>286.363983</td>
      <td>286.328400</td>
      <td>286.373444</td>
      <td>286.386017</td>
      <td>286.302185</td>
      <td>286.374878</td>
      <td>286.348358</td>
      <td>...</td>
      <td>286.243469</td>
      <td>286.283783</td>
      <td>286.173859</td>
      <td>286.309509</td>
      <td>286.296234</td>
      <td>286.341064</td>
      <td>286.341187</td>
      <td>286.376831</td>
      <td>286.321167</td>
      <td>286.254822</td>
    </tr>
    <tr>
      <th>1921-01-01 00:00:00</th>
      <td>286.250641</td>
      <td>286.198181</td>
      <td>286.287292</td>
      <td>286.390564</td>
      <td>286.309204</td>
      <td>286.334229</td>
      <td>286.311310</td>
      <td>286.300232</td>
      <td>286.315857</td>
      <td>286.305603</td>
      <td>...</td>
      <td>286.179413</td>
      <td>286.315643</td>
      <td>286.075104</td>
      <td>286.295990</td>
      <td>286.318085</td>
      <td>286.375305</td>
      <td>286.246063</td>
      <td>286.356201</td>
      <td>286.492493</td>
      <td>286.224274</td>
    </tr>
    <tr>
      <th>1922-01-01 00:00:00</th>
      <td>286.293488</td>
      <td>286.296356</td>
      <td>286.265686</td>
      <td>286.336517</td>
      <td>286.293579</td>
      <td>286.220093</td>
      <td>286.010773</td>
      <td>286.195099</td>
      <td>286.205170</td>
      <td>286.396545</td>
      <td>...</td>
      <td>286.142365</td>
      <td>286.316254</td>
      <td>286.140167</td>
      <td>286.293549</td>
      <td>286.327972</td>
      <td>286.142365</td>
      <td>286.412598</td>
      <td>286.369232</td>
      <td>286.503418</td>
      <td>286.282074</td>
    </tr>
    <tr>
      <th>1923-01-01 00:00:00</th>
      <td>286.329163</td>
      <td>286.322662</td>
      <td>286.251099</td>
      <td>286.322723</td>
      <td>286.237457</td>
      <td>286.152069</td>
      <td>286.066010</td>
      <td>286.204498</td>
      <td>286.271423</td>
      <td>286.292236</td>
      <td>...</td>
      <td>286.168762</td>
      <td>286.300781</td>
      <td>286.095490</td>
      <td>286.116302</td>
      <td>286.227905</td>
      <td>286.226471</td>
      <td>286.512909</td>
      <td>286.381348</td>
      <td>286.215302</td>
      <td>286.396332</td>
    </tr>
    <tr>
      <th>1924-01-01 00:00:00</th>
      <td>286.307465</td>
      <td>286.237366</td>
      <td>286.148895</td>
      <td>286.311890</td>
      <td>286.361694</td>
      <td>286.185974</td>
      <td>286.248322</td>
      <td>286.288177</td>
      <td>286.330444</td>
      <td>286.411835</td>
      <td>...</td>
      <td>286.143066</td>
      <td>286.287079</td>
      <td>286.234100</td>
      <td>286.199890</td>
      <td>286.252777</td>
      <td>286.322815</td>
      <td>286.256195</td>
      <td>286.221588</td>
      <td>286.247437</td>
      <td>286.422028</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div></div>
</div>
<p>Step 4 (similar to Step 3 in its execution time)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># This also takes a while</span>
<span class="n">t_rcp_ts_df</span> <span class="o">=</span> <span class="n">t_rcp_ts</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">t_rcp_ts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 12s, sys: 15.8 s, total: 1min 27s
Wall time: 23min 12s
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>member_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>101</th>
      <th>102</th>
      <th>103</th>
      <th>104</th>
      <th>105</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006-01-01 00:00:00</th>
      <td>286.764832</td>
      <td>286.960358</td>
      <td>286.679230</td>
      <td>286.793152</td>
      <td>286.754547</td>
      <td>287.022339</td>
      <td>286.850464</td>
      <td>287.089844</td>
      <td>286.960022</td>
      <td>286.775787</td>
      <td>...</td>
      <td>286.866089</td>
      <td>286.925049</td>
      <td>286.663971</td>
      <td>286.955414</td>
      <td>286.712524</td>
      <td>287.115601</td>
      <td>286.863556</td>
      <td>286.881683</td>
      <td>287.308411</td>
      <td>287.030334</td>
    </tr>
    <tr>
      <th>2007-01-01 00:00:00</th>
      <td>287.073792</td>
      <td>286.908539</td>
      <td>286.808746</td>
      <td>286.998901</td>
      <td>286.841675</td>
      <td>286.993042</td>
      <td>286.914124</td>
      <td>286.938965</td>
      <td>286.933563</td>
      <td>286.675385</td>
      <td>...</td>
      <td>286.804108</td>
      <td>286.849548</td>
      <td>286.628204</td>
      <td>287.010529</td>
      <td>286.811554</td>
      <td>287.187225</td>
      <td>286.862823</td>
      <td>287.008270</td>
      <td>287.222534</td>
      <td>287.239044</td>
    </tr>
    <tr>
      <th>2008-01-01 00:00:00</th>
      <td>287.104095</td>
      <td>286.815033</td>
      <td>286.995056</td>
      <td>287.081543</td>
      <td>287.100708</td>
      <td>286.960510</td>
      <td>286.854706</td>
      <td>286.878937</td>
      <td>287.062927</td>
      <td>286.702454</td>
      <td>...</td>
      <td>286.825653</td>
      <td>286.844086</td>
      <td>286.811859</td>
      <td>286.803741</td>
      <td>286.956635</td>
      <td>287.080994</td>
      <td>286.930084</td>
      <td>286.945801</td>
      <td>287.087128</td>
      <td>287.157745</td>
    </tr>
    <tr>
      <th>2009-01-01 00:00:00</th>
      <td>286.984497</td>
      <td>287.059448</td>
      <td>287.010498</td>
      <td>287.144714</td>
      <td>286.948700</td>
      <td>287.092316</td>
      <td>286.888458</td>
      <td>287.050934</td>
      <td>287.138428</td>
      <td>286.890839</td>
      <td>...</td>
      <td>286.785797</td>
      <td>286.876556</td>
      <td>286.953094</td>
      <td>287.060364</td>
      <td>287.056946</td>
      <td>287.124908</td>
      <td>287.005615</td>
      <td>287.083984</td>
      <td>287.254211</td>
      <td>287.060730</td>
    </tr>
    <tr>
      <th>2010-01-01 00:00:00</th>
      <td>286.991821</td>
      <td>287.102295</td>
      <td>286.988129</td>
      <td>286.875183</td>
      <td>286.954407</td>
      <td>287.121796</td>
      <td>286.938843</td>
      <td>287.116211</td>
      <td>286.957245</td>
      <td>287.049622</td>
      <td>...</td>
      <td>286.937317</td>
      <td>286.928314</td>
      <td>286.980499</td>
      <td>287.118713</td>
      <td>287.178040</td>
      <td>287.030212</td>
      <td>287.114716</td>
      <td>287.083038</td>
      <td>287.256927</td>
      <td>287.066528</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div></div>
</div>
</section>
<section id="get-observations-for-figure-2-hadcrut4-morice-et-al-2012">
<h3>Get observations for Figure 2 (HadCRUT4; Morice et al. 2012)<a class="headerlink" href="#get-observations-for-figure-2-hadcrut4-morice-et-al-2012" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Observational time series data for comparison with ensemble average:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsDataURL</span> <span class="o">=</span> <span class="s2">&quot;https://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/cru/hadcrut4/air.mon.anom.median.nc&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">obsDataURL</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 21MB
Dimensions:    (lat: 36, lon: 72, time: 2063, nbnds: 2)
Coordinates:
  * lat        (lat) float32 144B 87.5 82.5 77.5 72.5 ... -77.5 -82.5 -87.5
  * lon        (lon) float32 288B -177.5 -172.5 -167.5 ... 167.5 172.5 177.5
  * time       (time) datetime64[ns] 17kB 1850-01-01 1850-02-01 ... 2021-11-01
Dimensions without coordinates: nbnds
Data variables:
    time_bnds  (time, nbnds) datetime64[ns] 33kB 1850-01-01 ... 2021-11-30
    air        (time, lat, lon) float32 21MB nan nan nan nan ... nan nan nan nan
Attributes:
    platform:                        Surface
    title:                           HADCRUT4 Combined Air Temperature/SST An...
    history:                         Originally created at NOAA/ESRL PSD by C...
    Conventions:                     CF-1.0
    Comment:                         This dataset supersedes V3
    Source:                          Obtained from http://hadobs.metoffice.co...
    version:                         4.2.0
    _NCProperties:                   version=2,netcdf=4.6.3,hdf5=1.10.5
    References:                      https://www.psl.noaa.gov/data/gridded/da...
    dataset_title:                   HadCRUT4
    DODS_EXTRA.Unlimited_Dimension:  time</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a93ff5a6-2718-438f-b9e6-4e9b4384abaf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a93ff5a6-2718-438f-b9e6-4e9b4384abaf' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 36</li><li><span class='xr-has-index'>lon</span>: 72</li><li><span class='xr-has-index'>time</span>: 2063</li><li><span>nbnds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-45144b0d-5427-42c1-93aa-a23ce346deaf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45144b0d-5427-42c1-93aa-a23ce346deaf' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>87.5 82.5 77.5 ... -82.5 -87.5</div><input id='attrs-585435e0-cda5-44c2-b75d-9b375e121236' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-585435e0-cda5-44c2-b75d-9b375e121236' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-644e0739-3e5c-45ed-afa8-f1ab77e1ee5d' class='xr-var-data-in' type='checkbox'><label for='data-644e0739-3e5c-45ed-afa8-f1ab77e1ee5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[ 87.5 -87.5]</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>_ChunkSizes :</span></dt><dd>36</dd></dl></div><div class='xr-var-data'><pre>array([ 87.5,  82.5,  77.5,  72.5,  67.5,  62.5,  57.5,  52.5,  47.5,  42.5,
        37.5,  32.5,  27.5,  22.5,  17.5,  12.5,   7.5,   2.5,  -2.5,  -7.5,
       -12.5, -17.5, -22.5, -27.5, -32.5, -37.5, -42.5, -47.5, -52.5, -57.5,
       -62.5, -67.5, -72.5, -77.5, -82.5, -87.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-d098e8e7-533e-4861-99bf-afeecb4ee70d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d098e8e7-533e-4861-99bf-afeecb4ee70d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be3920a5-50c9-4fd3-b245-1fd8436b0d23' class='xr-var-data-in' type='checkbox'><label for='data-be3920a5-50c9-4fd3-b245-1fd8436b0d23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>[-177.5  177.5]</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>_ChunkSizes :</span></dt><dd>72</dd></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2021-11-01</div><input id='attrs-ac26ba26-5c61-4d95-91f8-479ac6c7481f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ac26ba26-5c61-4d95-91f8-479ac6c7481f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c80b5738-d110-4e64-80a3-ab648508603b' class='xr-var-data-in' type='checkbox'><label for='data-c80b5738-d110-4e64-80a3-ab648508603b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>delta_t :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>avg_period :</span></dt><dd>0000-01-00 00:00:00</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>coordinate_defines :</span></dt><dd>start</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>actual_range :</span></dt><dd>[18262. 81023.]</dd><dt><span>_ChunkSizes :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;,
       &#x27;1850-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-09-01T00:00:00.000000000&#x27;,
       &#x27;2021-10-01T00:00:00.000000000&#x27;, &#x27;2021-11-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-17e2ac27-51be-49a3-94fc-be30ffe3ecca' class='xr-section-summary-in' type='checkbox'  checked><label for='section-17e2ac27-51be-49a3-94fc-be30ffe3ecca' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, nbnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2021-11-30</div><input id='attrs-8dddb5ed-110b-49fe-acdb-1bb24775d504' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8dddb5ed-110b-49fe-acdb-1bb24775d504' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0397aa15-3226-4038-89b5-6e4fc1af6cf7' class='xr-var-data-in' type='checkbox'><label for='data-0397aa15-3226-4038-89b5-6e4fc1af6cf7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time Boundaries</dd><dt><span>_ChunkSizes :</span></dt><dd>[1 2]</dd></dl></div><div class='xr-var-data'><pre>array([[&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-01-31T00:00:00.000000000&#x27;],
       [&#x27;1850-02-01T00:00:00.000000000&#x27;, &#x27;1850-02-28T00:00:00.000000000&#x27;],
       [&#x27;1850-03-01T00:00:00.000000000&#x27;, &#x27;1850-03-31T00:00:00.000000000&#x27;],
       ...,
       [&#x27;2021-09-01T00:00:00.000000000&#x27;, &#x27;2021-09-30T00:00:00.000000000&#x27;],
       [&#x27;2021-10-01T00:00:00.000000000&#x27;, &#x27;2021-10-31T00:00:00.000000000&#x27;],
       [&#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-11-30T00:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>air</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-35460167-303b-414e-87b5-154d0cffb04f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35460167-303b-414e-87b5-154d0cffb04f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-732ef8a4-bba8-45ba-8690-e3f83dee052a' class='xr-var-data-in' type='checkbox'><label for='data-732ef8a4-bba8-45ba-8690-e3f83dee052a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>var_desc :</span></dt><dd>Air Temperature</dd><dt><span>level_desc :</span></dt><dd>Surface</dd><dt><span>statistic :</span></dt><dd>Anomaly</dd><dt><span>parent_stat :</span></dt><dd>Observation</dd><dt><span>valid_range :</span></dt><dd>[-40.  40.]</dd><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>HADCRUT4: Median Surface Air Temperature Monthly Median Anomaly from 100 ensemble members</dd><dt><span>precision :</span></dt><dd>2</dd><dt><span>cell_methods :</span></dt><dd>time: anomaly (monthly from values)</dd><dt><span>standard_name :</span></dt><dd>air_temperature_anomaly</dd><dt><span>actual_range :</span></dt><dd>[-9.9692100e+36  2.0620308e+01]</dd><dt><span>dataset :</span></dt><dd>HadCRUT4</dd><dt><span>_ChunkSizes :</span></dt><dd>[ 1 36 72]</dd></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
...
        [       nan,        nan,        nan, ..., 3.8943105 ,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [       nan,        nan,        nan, ..., 1.2897325 ,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-efdec45e-1d77-4582-91e4-d47f5aabe740' class='xr-section-summary-in' type='checkbox'  ><label for='section-efdec45e-1d77-4582-91e4-d47f5aabe740' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ec18e9ff-4c55-4546-b350-c2541597dc36' class='xr-index-data-in' type='checkbox'/><label for='index-ec18e9ff-4c55-4546-b350-c2541597dc36' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 87.5,  82.5,  77.5,  72.5,  67.5,  62.5,  57.5,  52.5,  47.5,  42.5,
        37.5,  32.5,  27.5,  22.5,  17.5,  12.5,   7.5,   2.5,  -2.5,  -7.5,
       -12.5, -17.5, -22.5, -27.5, -32.5, -37.5, -42.5, -47.5, -52.5, -57.5,
       -62.5, -67.5, -72.5, -77.5, -82.5, -87.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-14c39040-0f34-41de-a8d9-569d5f75e98e' class='xr-index-data-in' type='checkbox'/><label for='index-14c39040-0f34-41de-a8d9-569d5f75e98e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d9689695-8573-43fc-bfaa-3288aa380441' class='xr-index-data-in' type='checkbox'/><label for='index-d9689695-8573-43fc-bfaa-3288aa380441' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1850-01-01&#x27;, &#x27;1850-02-01&#x27;, &#x27;1850-03-01&#x27;, &#x27;1850-04-01&#x27;,
               &#x27;1850-05-01&#x27;, &#x27;1850-06-01&#x27;, &#x27;1850-07-01&#x27;, &#x27;1850-08-01&#x27;,
               &#x27;1850-09-01&#x27;, &#x27;1850-10-01&#x27;,
               ...
               &#x27;2021-02-01&#x27;, &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;,
               &#x27;2021-06-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;,
               &#x27;2021-10-01&#x27;, &#x27;2021-11-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=2063, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c4b754e5-f7ef-46a8-8082-3319e7d3477c' class='xr-section-summary-in' type='checkbox'  ><label for='section-c4b754e5-f7ef-46a8-8082-3319e7d3477c' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>platform :</span></dt><dd>Surface</dd><dt><span>title :</span></dt><dd>HADCRUT4 Combined Air Temperature/SST Anomaly</dd><dt><span>history :</span></dt><dd>Originally created at NOAA/ESRL PSD by CAS 04/2012 from files obtained at the Hadley Center</dd><dt><span>Conventions :</span></dt><dd>CF-1.0</dd><dt><span>Comment :</span></dt><dd>This dataset supersedes V3</dd><dt><span>Source :</span></dt><dd>Obtained from http://hadobs.metoffice.com/
Data is a collaboration of CRU and the Hadley Center</dd><dt><span>version :</span></dt><dd>4.2.0</dd><dt><span>_NCProperties :</span></dt><dd>version=2,netcdf=4.6.3,hdf5=1.10.5</dd><dt><span>References :</span></dt><dd>https://www.psl.noaa.gov/data/gridded/data.hadcrut4.html</dd><dt><span>dataset_title :</span></dt><dd>HadCRUT4</dd><dt><span>DODS_EXTRA.Unlimited_Dimension :</span></dt><dd>time</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weighted_temporal_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    weight by days in each month</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_bound_diff</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time_bnds</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;nbnds&quot;</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">wgts</span> <span class="o">=</span> <span class="n">time_bound_diff</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">time_bound_diff</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
        <span class="s2">&quot;time.year&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">ALL_DIMS</span><span class="p">)</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;air&quot;</span><span class="p">]</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="n">ones</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">obs_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">obs</span> <span class="o">*</span> <span class="n">wgts</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">ones_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">ones</span> <span class="o">*</span> <span class="n">wgts</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">obs_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">obs_sum</span> <span class="o">/</span> <span class="n">ones_out</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">obs_s</span>
</pre></div>
</div>
</div>
</div>
<p>Limit observations to 20th century:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_s</span> <span class="o">=</span> <span class="n">weighted_temporal_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">obs_s</span> <span class="o">=</span> <span class="n">obs_s</span><span class="p">[</span><span class="s1">&#39;1920&#39;</span><span class="p">:]</span>
<span class="n">obs_s</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time
1920-01-01   -0.262006
1921-01-01   -0.195891
1922-01-01   -0.301986
1923-01-01   -0.269062
1924-01-01   -0.292857
Freq: YS-JAN, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_ts_anom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t_20c_ts_df</span><span class="p">,</span> <span class="n">t_rcp_ts_df</span><span class="p">])</span> <span class="o">-</span> <span class="n">t_ref_mean</span><span class="o">.</span><span class="n">data</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">all_ts_anom</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">obs_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">obs_s</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Combine ensemble member 1 data from historical and 20th century experiments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist_anom</span> <span class="o">=</span> <span class="n">t_hist_ts_df</span> <span class="o">-</span> <span class="n">t_ref_mean</span><span class="o">.</span><span class="n">data</span>
<span class="n">member1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hist_anom</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">all_ts_anom</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">member1_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">member1</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-figure-2">
<h3>Plotting Figure 2<a class="headerlink" href="#plotting-figure-2" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Global surface temperature anomaly (1961-90 base period) for individual ensemble members, and observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">grid_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">all_ts_anom</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs_years</span><span class="p">,</span> <span class="n">obs_s</span><span class="p">[</span><span class="s1">&#39;1920&#39;</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">member1_years</span><span class="p">,</span> <span class="n">member1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">0.35</span><span class="p">,</span>
    <span class="mf">0.4</span><span class="p">,</span>
    <span class="s2">&quot;observations&quot;</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">0.35</span><span class="p">,</span>
    <span class="mf">0.33</span><span class="p">,</span>
    <span class="s2">&quot;members 2-40&quot;</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">0.05</span><span class="p">,</span>
    <span class="mf">0.2</span><span class="p">,</span>
    <span class="s2">&quot;member 1&quot;</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1950</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2050</span><span class="p">,</span> <span class="mi">2100</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Global Surface</span><span class="se">\n</span><span class="s2">Temperature Anomaly (K)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9bcdbd054843307f0a22bd783b7a5f42c5353dcfa480175160ed7352b071b7a0.png" src="../../_images/9bcdbd054843307f0a22bd783b7a5f42c5353dcfa480175160ed7352b071b7a0.png" />
</div>
</div>
</section>
</section>
<section id="figure-4">
<h2>Figure 4<a class="headerlink" href="#figure-4" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<section id="compute-linear-trend-for-winter-seasons">
<h3>Compute linear trend for winter seasons<a class="headerlink" href="#compute-linear-trend-for-winter-seasons" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linear_trend</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">):</span>
    <span class="n">da_chunk</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span>
        <span class="n">calc_slope</span><span class="p">,</span>
        <span class="n">da_chunk</span><span class="p">,</span>
        <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="n">dim</span><span class="p">]],</span>
        <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[]],</span>
        <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">trend</span>


<span class="k">def</span> <span class="nf">calc_slope</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ufunc to be used by linear_trend&quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

    <span class="c1"># drop missing values (NaNs) from x and y</span>
    <span class="n">finite_indexes</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">finite_indexes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">finite_indexes</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">finite_indexes</span><span class="p">],</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">slope</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-ensemble-trends">
<h3>Compute ensemble trends<a class="headerlink" href="#compute-ensemble-trends" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span> 
<span class="c1"># Takes several minutes</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t_20c</span><span class="p">,</span> <span class="n">t_rcp</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1979&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;QS-DEC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="c1"># Include only full seasons from 1979 and 2012</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="n">seasons</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1979&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 34 s, sys: 6.66 s, total: 40.7 s
Wall time: 8min 32s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winter_seasons</span> <span class="o">=</span> <span class="n">seasons</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="n">seasons</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">seasons</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">12</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">winter_trends</span> <span class="o">=</span> <span class="n">linear_trend</span><span class="p">(</span>
    <span class="n">winter_seasons</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">winter_seasons</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<span class="c1"># Compute ensemble mean from the first 30 members</span>
<span class="n">winter_trends_mean</span> <span class="o">=</span> <span class="n">winter_trends</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">member_id</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;member_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Make sure that we have 34 seasons:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">winter_seasons</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">==</span> <span class="mi">34</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-observations-for-figure-4-nasa-giss-gistemp">
<h3>Get observations for Figure 4 (NASA GISS GisTemp)<a class="headerlink" href="#get-observations-for-figure-4-nasa-giss-gistemp" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>This is observational time series data for comparison with ensemble average (NASA GISS Surface Temperature Analysis, https://data.giss.nasa.gov/gistemp/).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsDataURL</span> <span class="o">=</span> <span class="s2">&quot;https://data.giss.nasa.gov/pub/gistemp/gistemp1200_GHCNv4_ERSSTv5.nc.gz&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Download, unzip, and load file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;wget &quot;</span> <span class="o">+</span> <span class="n">obsDataURL</span><span class="p">)</span>

<span class="n">obsDataFileName</span> <span class="o">=</span> <span class="n">obsDataURL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gunzip &quot;</span> <span class="o">+</span> <span class="n">obsDataFileName</span><span class="p">)</span>

<span class="n">obsDataFileName</span> <span class="o">=</span> <span class="n">obsDataFileName</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">obsDataFileName</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2024-04-01 23:10:17--  https://data.giss.nasa.gov/pub/gistemp/gistemp1200_GHCNv4_ERSSTv5.nc.gz
Resolving data.giss.nasa.gov (data.giss.nasa.gov)... 129.164.128.233, 2001:4d0:2310:230::233
Connecting to data.giss.nasa.gov (data.giss.nasa.gov)|129.164.128.233|:443... connected.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 200 OK
Length: 25398620 (24M) [application/x-gzip]
Saving to: ‘gistemp1200_GHCNv4_ERSSTv5.nc.gz’

     0K .......... .......... .......... .......... ..........  0%  623K 40s
    50K .......... .......... .......... .......... ..........  0% 1.23M 30s
   100K .......... .......... .......... .......... ..........  0% 57.6M 20s
   150K .......... .......... .......... .......... ..
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>........  0% 1.27M 20s
   200K .......... .......... .......... .......... ..........  1% 58.0M 16s
   250K .......... .......... .......... .......... ..........  1%  122M 13s
   300K .......... .......... .......... .......... ..........  1% 98.0M 11s
   350K .......... .......... .......... .......... ..........  1%  130M 10s
   400K .......... .......... .......... .......... ..........  1% 1.29M 11s
   450K .......... .......... .......... .......... ..........  2% 75.9M 10s
   500K .......... .......... .......... .......... ..........  2% 85.4M 9s
   550K .......... .......... .......... .......... ..........  2% 72.7M 8s
   600K .......... .......... .......... .......... ..........  2%  106M 7s
   650K .......... .......... .......... .......... ..........  2%  639K 10s
   700K .......... .......... .......... .......... ..........  3%  196M 9s
   750K .......... .......... .......... .......... ..........  3%  221M 8s
   800K .......... .......... .......... .......... ..........  3%  155M 8s
   850K .......... .......... .......... .......... ..........  3%  235M 7s
   900K .......... .......... .......... .......... ..........  3%  218M 7s
   950K .......... .......... .......... .......... ..........  4%  209M 7s
  1000K .......... .......... .......... .......... ..........  4%  174M 6s
  1050K .......... .......... .......... .......... ..........  4%  182M 6s
  1100K .......... .......... .......... .......... ..........  4%  143M 6s
  1150K .......... .......... .......... .......... ..........  4%  225M 6s
  1200K .......... .......... .......... .......... ..........  5% 3.53M 6s
  1250K .......... .......... .......... .......... ..........  5%  128M 5s
  1300K .......... .......... .......... .......... ..........  5%  126M 5s
  1350K .......... .......... .......... .......... ..........  5%  114M 5s
  1400K .......... .......... .......... .......... ..........  5%  128M 5s
  1450K .......... .......... .......... .......... ..........  6%  238M 5s
  1500K .......... .......... .......... .......... ..........  6%  262M 4s
  1550K .......... .......... .......... .......... ..........  6%  237M 4s
  1600K .......... .......... .......... .......... ..........  6%  200M 4s
  1650K .......... .......... .......... .......... ..........  6%  252M 4s
  1700K .......... .......... .......... .......... ..........  7%  256M 4s
  1750K .......... .......... .......... .......... ..........  7%  236M 4s
  1800K .......... .......... .......... .......... ..........  7% 2.42M 4s
  1850K .......... .......... .......... .......... ..........  7% 29.9M 4s
  1900K .......... .......... .......... .......... ..........  7%  104M 4s
  1950K .......... .......... .......... .......... ..........  8%  107M 4s
  2000K .......... .......... .......... .......... ..........  8% 29.3M 4s
  2050K .......... .......... .......... .......... ..........  8%  101M 4s
  2100K .......... .......... .......... .......... ..........  8% 75.8M 3s
  2150K .......... .......... .......... .......... ..........  8% 4.36M 3s
  2200K .......... .......... .......... .......... ..........  9% 43.3M 3s
  2250K .......... .......... .......... .......... ..........  9% 48.7M 3s
  2300K .......... .......... .......... .......... ..........  9% 49.3M 3s
  2350K ..
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>........ .......... .......... .......... ..........  9% 2.23M 3s
  2400K .......... .......... .......... .......... ..........  9% 87.5M 3s
  2450K .......... .......... .......... .......... .......... 10% 90.7M 3s
  2500K .......... .......... .......... .......... .......... 10% 33.5M 3s
  2550K .......... .......... .......... .......... .......... 10% 96.0M 3s
  2600K .......... .......... .......... .......... .......... 10% 52.7M 3s
  2650K .......... .......... .......... .......... .......... 10% 4.47M 3s
  2700K .......... .......... .......... .......... .......... 11% 50.2M 3s
  2750K .......... .......... .......... .......... .......... 11% 55.8M 3s
  2800K .......... .......... .......... .......... .......... 11% 2.34M 3s
  2850K .......... .......... .......... .......... .......... 11% 22.7M 3s
  2900K .......... .......... .......... .......... .......... 11% 54.8M 3s
  2950K .......... .......... .......... .......... .......... 12%  110M 3s
  3000K .......... .......... .......... .......... .......... 12% 36.3M 3s
  3050K .......... .......... .......... .......... .......... 12% 99.1M 3s
  3100K .......... .......... .......... .......... .......... 12% 55.0M 3s
  3150K .......... .......... .......... .......... .......... 12% 4.57M 3s
  3200K .......... .......... .......... .......... .......... 13% 40.4M 3s
  3250K .......... .......... .......... .......... .......... 13% 57.3M 3s
  3300K .......... .......... .......... .......... .......... 13% 2.34M 3s
  3350K .......... .......... .......... .......... .......... 13% 23.4M 3s
  3400K .......... .......... .......... .......... .......... 13% 52.4M 3s
  3450K .......... .......... .......... .......... .......... 14%  118M 3s
  3500K .......... .......... .......... .......... .......... 14% 32.5M 3s
  3550K .......... .......... .......... .......... .......... 14% 89.4M 3s
  3600K .......... .......... .......... .......... .......... 14% 59.9M 3s
  3650K .......... .......... .......... .......... .......... 14% 4.30M 3s
  3700K .......... .......... .......... .......... .......... 15%  125M 3s
  3750K .......... .......... .......... .......... .......... 15% 77.2M 3s
  3800K .......... .......... .......... .......... .......... 15% 41.6M 2s
  3850K .......... .......... .......... .......... .......... 15% 2.22M 3s
  3900K .......... .......... .......... .......... .......... 15% 70.6M 3s
  3950K .......... .......... .......... .......... .......... 16%  100M 3s
  4000K .......... .......... .......... .......... .......... 16% 26.3M 2s
  4050K .......... .......... .......... .......... .......... 16% 91.4M 2s
  4100K .......... .......... .......... .......... .......... 16% 59.5M 2s
  4150K .......... .......... .......... .......... .......... 16% 5.04M 2s
  4200K .......... .......... .......... .......... .......... 17% 26.9M 2s
  4250K .......... .......... .......... .......... .......... 17%  104M 2s
  4300K .......... .......... .......... .......... .......... 17% 31.1M 2s
  4350K .......... .......... .......... .......... .......... 17% 2.28M 2s
  4400K .......... .......... .......... .......... .......... 17% 45.3M 2s
  4450K .......... .......... .......... .......... .......... 18% 71.6M 2s
  4500K .......... .......... .......... .......... .......... 18% 31.8M 2s
  4550K .......... .......... .......... .......... .......... 18%  101M 2s
  4600K .......... .......... .......... .......... .......... 18% 60.2M 2s
  4650K .......... .......... .......... .......... .......... 18% 41.6M 2s
  4700K .......... .......... .......... .......... .......... 19% 4.80M 2s
  4750K .......... .......... .......... .......... .......... 19% 90.8M 2s
  4800K .......... .......... .......... .......... .......... 19% 26.9M 2s
  4850K .......... .......... .......... .......... .......... 19% 2.28M 2s
  4900K .......... .......... .......... .......... .......... 19% 67.0M 2s
  4950K ..........
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> .......... .......... .......... .......... 20% 44.5M 2s
  5000K .......... .......... .......... .......... .......... 20% 30.4M 2s
  5050K .......... .......... .......... .......... .......... 20% 90.5M 2s
  5100K .......... .......... .......... .......... .......... 20% 90.7M 2s
  5150K .......... .......... .......... .......... .......... 20% 35.1M 2s
  5200K .......... .......... .......... .......... .......... 21% 4.80M 2s
  5250K .......... .......... .......... .......... .......... 21% 89.0M 2s
  5300K .......... .......... .......... .......... .......... 21% 28.1M 2s
  5350K .......... .......... .......... .......... .......... 21% 2.35M 2s
  5400K .......... .......... .......... .......... .......... 21% 41.1M 2s
  5450K .......... .......... .......... .......... .......... 22% 39.2M 2s
  5500K .......... .......... .......... .......... .......... 22%  126M 2s
  5550K .......... .......... .......... .......... .......... 22% 32.0M 2s
  5600K .......... .......... .......... .......... .......... 22% 91.2M 2s
  5650K .......... .......... .......... .......... .......... 22% 50.8M 2s
  5700K .......... .......... .......... .......... .......... 23% 4.02M 2s
  5750K .......... .......... .......... .......... .......... 23%  103M 2s
  5800K .......... .......... .......... .......... .......... 23%  114M 2s
  5850K .......... .......... .......... .......... .......... 23% 42.7M 2s
  5900K .......... .......... .......... .......... .......... 23% 2.35M 2s
  5950K .......... .......... .......... .......... .......... 24% 41.8M 2s
  6000K .......... .......... .......... .......... .......... 24% 37.5M 2s
  6050K .......... .......... .......... .......... .......... 24% 59.2M 2s
  6100K .......... .......... .......... .......... .......... 24% 92.2M 2s
  6150K .......... .......... .......... .......... .......... 24% 95.9M 2s
  6200K .......... .......... .......... .......... .......... 25% 34.1M 2s
  6250K .......... .......... .......... .......... .......... 25% 4.25M 2s
  6300K .......... .......... .......... .......... .......... 25% 93.0M 2s
  6350K .......... .......... .......... .......... .......... 25%  117M 2s
  6400K .......... .......... .......... .......... .......... 26% 2.23M 2s
  6450K .......... .......... .......... .......... .......... 26% 99.1M 2s
  6500K .......... .......... .......... .......... .......... 26% 63.1M 2s
  6550K .......... .......... .......... .......... .......... 26% 33.2M 2s
  6600K .......... .......... .......... .......... .......... 26% 65.0M 2s
  6650K .......... .......... .......... .......... .......... 27%  116M 2s
  6700K .......... .......... .......... .......... .......... 27% 57.0M 2s
  6750K .......... .......... .......... .......... .......... 27% 4.01M 2s
  6800K .......... .......... .......... .......... .......... 27% 84.6M 2s
  6850K .......... .......... .......... .......... .......... 27%  103M 2s
  6900K .......... .......... .......... .......... .......... 28% 2.38M 2s
  6950K .......... .......... .......... .......... .......... 28% 33.4M 2s
  7000K .......... .......... .......... .......... .......... 28% 79.4M 2s
  7050K .......... .......... .......... .......... .......... 28% 33.4M 2s
  7100K .......... .......... .......... .......... .......... 28% 45.1M 2s
  7150K .......... .......... .......... .......... .......... 29%  103M 2s
  7200K .......... .......... .......... .......... .......... 29% 73.7M 2s
  7250K .......... .......... .......... .......... .......... 29% 4.01M 2s
  7300K .......... .......... .......... .......... .......... 29%  101M 2s
  7350K .......... .......... .......... .......... .......... 29% 69.8M 2s
  7400K .......... .......... .......... .......... .......... 30%  106M 2s
  7450K .......... .......... .......... .......... .......... 30% 2.25M 2s
  7500K .......... .......... .......... .......... .......... 30% 96.3M 2s
  7550K .......... .......... .......... .......... .......... 30% 80.6M 2s
  7600K .......... .......... .......... .......... .......... 30% 31.5M 2s
  7650K .......... ....
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...... .......... .......... .......... 31% 46.6M 2s
  7700K .......... .......... .......... .......... .......... 31% 83.2M 2s
  7750K .......... .......... .......... .......... .......... 31%  105M 2s
  7800K .......... .......... .......... .......... .......... 31% 4.05M 2s
  7850K .......... .......... .......... .......... .......... 31%  118M 2s
  7900K .......... .......... .......... .......... .......... 32% 75.8M 2s
  7950K .......... .......... .......... .......... .......... 32% 2.48M 2s
  8000K .......... .......... .......... .......... .......... 32% 20.7M 2s
  8050K .......... .......... .......... .......... .......... 32% 61.8M 2s
  8100K .......... .......... .......... .......... .......... 32% 35.6M 2s
  8150K .......... .......... .......... .......... .......... 33% 57.1M 2s
  8200K .......... .......... .......... .......... .......... 33% 67.2M 2s
  8250K .......... .......... .......... .......... .......... 33% 67.2M 2s
  8300K .......... .......... .......... .......... .......... 33% 15.6M 2s
  8350K .......... .......... .......... .......... .......... 33% 5.25M 2s
  8400K .......... .......... .......... .......... .......... 34% 87.3M 2s
  8450K .......... .......... .......... .......... .......... 34% 94.2M 2s
  8500K .......... .......... .......... .......... .......... 34% 2.23M 2s
  8550K .......... .......... .......... .......... .......... 34%  105M 2s
  8600K .......... .......... .......... .......... .......... 34% 73.3M 2s
  8650K .......... .......... .......... .......... .......... 35% 39.0M 2s
  8700K .......... .......... .......... .......... .......... 35% 89.9M 2s
  8750K .......... .......... .......... .......... .......... 35% 50.9M 2s
  8800K .......... .......... .......... .......... .......... 35% 62.9M 2s
  8850K .......... .......... .......... .......... .......... 35% 4.17M 2s
  8900K .......... .......... .......... .......... .......... 36% 77.5M 2s
  8950K .......... .......... .......... .......... .......... 36% 61.5M 2s
  9000K .......... .......... .......... .......... .......... 36% 51.1M 1s
  9050K .......... .......... .......... .......... .......... 36% 2.32M 2s
  9100K .......... .......... .......... .......... .......... 36% 52.2M 2s
  9150K .......... .......... .......... .......... .......... 37%  113M 1s
  9200K .......... .......... .......... .......... .......... 37% 38.8M 1s
  9250K .......... .......... .......... .......... .......... 37% 54.7M 1s
  9300K .......... .......... .......... .......... .......... 37% 68.4M 1s
  9350K .......... .......... .......... .......... .......... 37%  105M 1s
  9400K .......... .......... .......... .......... .......... 38% 4.19M 1s
  9450K .......... .......... .......... .......... .......... 38%  101M 1s
  9500K .......... .......... .......... .......... .......... 38% 45.7M 1s
  9550K .......... .......... .......... .......... .......... 38% 2.56M 1s
  9600K .......... .......... .......... .......... .......... 38% 14.5M 1s
  9650K .......... .......... .......... .......... .......... 39% 76.7M 1s
  9700K .......... .......... .......... .......... .......... 39%  105M 1s
  9750K .......... .......... .......... .......... .......... 39% 53.5M 1s
  9800K .......... .......... .......... .......... .......... 39% 46.3M 1s
  9850K .......... .......... .......... .......... .......... 39% 60.1M 1s
  9900K .......... .......... .......... .......... .......... 40% 51.6M 1s
  9950K .......... .......... .......... .......... .......... 40% 4.42M 1s
 10000K .......... .......... .......... .......... .......... 40% 44.4M 1s
 10050K .......... .......... .......... .......... .......... 40%  119M 1s
 10100K .......... .......... .......... .......... .......... 40% 2.28M 1s
 10150K .......... .......... .......... .......... .......... 41% 44.0M 1s
 10200K .......... .......... .......... .......... .......... 41%  116M 1s
 10250K .......... .......... .......... .......... .......... 41% 86.8M 1s
 10300K .......... .......... .......... .......... .......... 41% 50.8M 1s
 10350K .......... .......... .......... .......... .......... 41% 45.2M 1s
 10400K .......... .......... .......... .......... .......... 42% 53.2M 1s
 10450K .......... ....
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...... .......... .......... .......... 42% 18.6M 1s
 10500K .......... .......... .......... .......... .......... 42% 5.28M 1s
 10550K .......... .......... .......... .......... .......... 42% 49.1M 1s
 10600K .......... .......... .......... .......... .......... 42% 79.3M 1s
 10650K .......... .......... .......... .......... .......... 43% 2.31M 1s
 10700K .......... .......... .......... .......... .......... 43% 41.0M 1s
 10750K .......... .......... .......... .......... .......... 43% 55.8M 1s
 10800K .......... .......... .......... .......... .......... 43% 71.3M 1s
 10850K .......... .......... .......... .......... .......... 43% 36.6M 1s
 10900K .......... .......... .......... .......... .......... 44%  104M 1s
 10950K .......... .......... .......... .......... .......... 44%  100M 1s
 11000K .......... .......... .......... .......... .......... 44% 18.0M 1s
 11050K .......... .......... .......... .......... .......... 44% 5.12M 1s
 11100K .......... .......... .......... .......... .......... 44% 55.4M 1s
 11150K .......... .......... .......... .......... .......... 45% 63.1M 1s
 11200K .......... .......... .......... .......... .......... 45% 2.31M 1s
 11250K .......... .......... .......... .......... .......... 45% 38.4M 1s
 11300K .......... .......... .......... .......... .......... 45% 92.7M 1s
 11350K .......... .......... .......... .......... .......... 45% 91.4M 1s
 11400K .......... .......... .......... .......... .......... 46% 65.9M 1s
 11450K .......... .......... .......... .......... .......... 46% 35.8M 1s
 11500K .......... .......... .......... .......... .......... 46%  103M 1s
 11550K .......... .......... .......... .......... .......... 46% 19.9M 1s
 11600K .......... .......... .......... .......... .......... 46% 4.99M 1s
 11650K .......... .......... .......... .......... .......... 47% 72.8M 1s
 11700K .......... .......... .......... .......... .......... 47% 49.7M 1s
 11750K .......... .......... .......... .......... .......... 47% 2.36M 1s
 11800K .......... .......... .......... .......... .......... 47% 32.3M 1s
 11850K .......... .......... .......... .......... .......... 47% 79.8M 1s
 11900K .......... .......... .......... .......... .......... 48% 61.5M 1s
 11950K .......... .......... .......... .......... .......... 48%  109M 1s
 12000K .......... .......... .......... .......... .......... 48% 31.5M 1s
 12050K .......... .......... .......... .......... .......... 48% 74.6M 1s
 12100K .......... .......... .......... .......... .......... 48% 22.1M 1s
 12150K .......... .......... .......... .......... .......... 49% 5.23M 1s
 12200K .......... .......... .......... .......... .......... 49% 53.6M 1s
 12250K .......... .......... .......... .......... .......... 49% 60.6M 1s
 12300K .......... .......... .......... .......... .......... 49% 2.34M 1s
 12350K .......... .......... .......... .......... .......... 49% 34.2M 1s
 12400K .......... .......... .......... .......... .......... 50% 68.0M 1s
 12450K .......... .......... .......... .......... .......... 50% 71.7M 1s
 12500K .......... .......... .......... .......... .......... 50% 29.6M 1s
 12550K .......... .......... .......... .......... .......... 50% 93.3M 1s
 12600K .......... .......... .......... .......... .......... 51%  108M 1s
 12650K .......... .......... .......... .......... .......... 51% 21.0M 1s
 12700K .......... .......... .......... .......... .......... 51% 5.53M 1s
 12750K .......... .......... .......... .......... .......... 51% 41.4M 1s
 12800K .......... .......... .......... .......... .......... 51% 43.7M 1s
 12850K .......... .......... .......... .......... .......... 52% 2.34M 1s
 12900K .......... .......... .......... .......... .......... 52% 35.8M 1s
 12950K .......... .......... .......... .......... .......... 52% 56.0M 1s
 13000K .......... .......... .......... .......... .......... 52% 85.1M 1s
 13050K .......... .......... .......... .......... .......... 52% 62.2M 1s
 13100K .......... .......... .......... .......... .......... 53% 32.5M 1s
 13150K .......... .......... .......... .......... .......... 53% 95.4M 1s
 13200K .......... .......... .......... ..
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>........ .......... 53% 7.21M 1s
 13250K .......... .......... .......... .......... .......... 53% 10.9M 1s
 13300K .......... .......... .......... .......... .......... 53% 37.4M 1s
 13350K .......... .......... .......... .......... .......... 54% 94.7M 1s
 13400K .......... .......... .......... .......... .......... 54% 2.33M 1s
 13450K .......... .......... .......... .......... .......... 54% 39.6M 1s
 13500K .......... .......... .......... .......... .......... 54% 46.8M 1s
 13550K .......... .......... .......... .......... .......... 54% 54.6M 1s
 13600K .......... .......... .......... .......... .......... 55% 71.8M 1s
 13650K .......... .......... .......... .......... .......... 55% 36.6M 1s
 13700K .......... .......... .......... .......... .......... 55%  123M 1s
 13750K .......... .......... .......... .......... .......... 55% 69.5M 1s
 13800K .......... .......... .......... .......... .......... 55% 7.55M 1s
 13850K .......... .......... .......... .......... .......... 56% 10.6M 1s
 13900K .......... .......... .......... .......... .......... 56% 41.4M 1s
 13950K .......... .......... .......... .......... .......... 56% 54.6M 1s
 14000K .......... .......... .......... .......... .......... 56% 2.27M 1s
 14050K .......... .......... .......... .......... .......... 56% 47.9M 1s
 14100K .......... .......... .......... .......... .......... 57% 54.7M 1s
 14150K .......... .......... .......... .......... .......... 57% 59.6M 1s
 14200K .......... .......... .......... .......... .......... 57% 54.7M 1s
 14250K .......... .......... .......... .......... .......... 57% 65.2M 1s
 14300K .......... .......... .......... .......... .......... 57% 85.8M 1s
 14350K .......... .......... .......... .......... .......... 58% 7.01M 1s
 14400K .......... .......... .......... .......... .......... 58% 11.0M 1s
 14450K .......... .......... .......... .......... .......... 58% 45.8M 1s
 14500K .......... .......... .......... .......... .......... 58% 20.8M 1s
 14550K .......... .......... .......... .......... .......... 58% 2.45M 1s
 14600K .......... .......... .......... .......... .......... 59% 56.7M 1s
 14650K .......... .......... .......... .......... .......... 59% 81.8M 1s
 14700K .......... .......... .......... .......... .......... 59% 49.3M 1s
 14750K .......... .......... .......... .......... .......... 59% 48.6M 1s
 14800K .......... .......... .......... .......... .......... 59% 57.4M 1s
 14850K .......... .......... .......... .......... .......... 60% 73.4M 1s
 14900K .......... .......... .......... .......... .......... 60% 6.97M 1s
 14950K .......... .......... .......... .......... .......... 60% 11.7M 1s
 15000K .......... .......... .......... .......... .......... 60% 56.4M 1s
 15050K .......... .......... .......... .......... .......... 60% 48.4M 1s
 15100K .......... .......... .......... .......... .......... 61% 2.40M 1s
 15150K .......... .......... .......... .......... .......... 61% 26.5M 1s
 15200K .......... .......... .......... .......... .......... 61% 46.5M 1s
 15250K .......... .......... .......... .......... .......... 61% 45.4M 1s
 15300K .......... .......... .......... .......... .......... 61% 76.0M 1s
 15350K .......... .......... .......... .......... .......... 62% 48.8M 1s
 15400K .......... .......... .......... .......... .......... 62% 73.4M 1s
 15450K .......... .......... .......... .......... .......... 62%  115M 1s
 15500K .......... .......... .......... .......... .......... 62% 6.79M 1s
 15550K .......... .......... .......... .......... .......... 62% 11.0M 1s
 15600K .......... .......... .......... .......... .......... 63% 40.3M 1s
 15650K .......... .......... .......... .......... .......... 63% 16.4M 1s
 15700K .......... .......... .......... .......... .......... 63% 2.59M 1s
 15750K .......... .......... .......... .......... .......... 63% 56.6M 1s
 15800K .......... .......... .......... .......... .......... 63% 30.2M 1s
 15850K .......... .......... .......... .......... .......... 64%  116M 1s
 15900K .......... .......... .......... .......... .......... 64% 83.6M 1s
 15950K .......... .......... .......... .......... .......... 64% 43.1M 1s
 16000K .......... .......... .......... .......... .......... 64% 89.8M 1s
 16050K .......... .......... .......... .......... .......... 64% 7.01M 1s
 16100K .......... ..
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>........ .......... .......... .......... 65% 12.8M 1s
 16150K .......... .......... .......... .......... .......... 65% 40.5M 1s
 16200K .......... .......... .......... .......... .......... 65% 47.6M 1s
 16250K .......... .......... .......... .......... .......... 65% 2.31M 1s
 16300K .......... .......... .......... .......... .......... 65% 43.2M 1s
 16350K .......... .......... .......... .......... .......... 66% 82.6M 1s
 16400K .......... .......... .......... .......... .......... 66% 20.5M 1s
 16450K .......... .......... .......... .......... .......... 66%  117M 1s
 16500K .......... .......... .......... .......... .......... 66% 86.0M 1s
 16550K .......... .......... .......... .......... .......... 66%  105M 1s
 16600K .......... .......... .......... .......... .......... 67% 7.40M 1s
 16650K .......... .......... .......... .......... .......... 67% 40.8M 1s
 16700K .......... .......... .......... .......... .......... 67% 10.9M 1s
 16750K .......... .......... .......... .......... .......... 67% 95.7M 1s
 16800K .......... .......... .......... .......... .......... 67% 2.67M 1s
 16850K .......... .......... .......... .......... .......... 68% 11.6M 1s
 16900K .......... .......... .......... .......... .......... 68%  122M 1s
 16950K .......... .......... .......... .......... .......... 68% 29.1M 1s
 17000K .......... .......... .......... .......... .......... 68% 44.7M 1s
 17050K .......... .......... .......... .......... .......... 68% 84.7M 1s
 17100K .......... .......... .......... .......... .......... 69% 84.1M 1s
 17150K .......... .......... .......... .......... .......... 69%  100M 1s
 17200K .......... .......... .......... .......... .......... 69% 7.10M 1s
 17250K .......... .......... .......... .......... .......... 69% 10.1M 1s
 17300K .......... .......... .......... .......... .......... 69%  107M 1s
 17350K .......... .......... .......... .......... .......... 70% 31.9M 1s
 17400K .......... .......... .......... .......... .......... 70% 2.60M 1s
 17450K .......... .......... .......... .......... .......... 70% 19.3M 1s
 17500K .......... .......... .......... .......... .......... 70% 76.0M 1s
 17550K .......... .......... .......... .......... .......... 70% 23.2M 1s
 17600K .......... .......... .......... .......... .......... 71% 58.9M 1s
 17650K .......... .......... .......... .......... .......... 71%  110M 1s
 17700K .......... .......... .......... .......... .......... 71% 91.8M 1s
 17750K .......... .......... .......... .......... .......... 71%  108M 1s
 17800K .......... .......... .......... .......... .......... 71% 5.99M 1s
 17850K .......... .......... .......... .......... .......... 72% 13.3M 1s
 17900K .......... .......... .......... .......... .......... 72%  102M 1s
 17950K .......... .......... .......... .......... .......... 72% 23.6M 1s
 18000K .......... .......... .......... .......... .......... 72% 2.48M 1s
 18050K .......... .......... .......... .......... .......... 72% 42.3M 1s
 18100K .......... .......... .......... .......... .......... 73% 33.7M 1s
 18150K .......... .......... .......... .......... .......... 73% 40.9M 1s
 18200K .......... .......... .......... .......... .......... 73%  103M 1s
 18250K .......... .......... .......... .......... .......... 73% 71.0M 1s
 18300K .......... .......... .......... .......... .......... 73% 53.3M 1s
 18350K .......... .......... .......... .......... .......... 74% 7.49M 1s
 18400K .......... .......... .......... .......... .......... 74% 9.83M 1s
 18450K .......... .......... .......... .......... .......... 74% 79.3M 1s
 18500K .......... .......... .......... .......... .......... 74% 96.4M 1s
 18550K .......... .......... .......... .......... .......... 74% 2.53M 1s
 18600K .......... .......... .......... .......... .......... 75% 18.6M 1s
 18650K .......... .......... .......... .......... .......... 75% 57.7M 1s
 18700K .......... .......... .......... .......... .......... 75% 25.3M 1s
 18750K .......... .......... .......... .......... .......... 75% 82.0M 0s
 18800K .......... .......... .......... .......... .......... 75% 60.9M 0s
 18850K .......... .......... .......... .......... .......... 76% 89.1M 0s
 18900K .......... .......... .......... .......... .......... 76% 82.2M 0s
 18950K .......... .......... .......... .......... .......... 76% 7.37M 0s
 19000K .......... .......... ....
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...... .......... .......... 76% 10.3M 0s
 19050K .......... .......... .......... .......... .......... 77% 48.5M 0s
 19100K .......... .......... .......... .......... .......... 77% 34.5M 0s
 19150K .......... .......... .......... .......... .......... 77% 2.50M 0s
 19200K .......... .......... .......... .......... .......... 77% 27.9M 0s
 19250K .......... .......... .......... .......... .......... 77% 71.3M 0s
 19300K .......... .......... .......... .......... .......... 78% 26.9M 0s
 19350K .......... .......... .......... .......... .......... 78% 90.4M 0s
 19400K .......... .......... .......... .......... .......... 78% 84.9M 0s
 19450K .......... .......... .......... .......... .......... 78% 60.1M 0s
 19500K .......... .......... .......... .......... .......... 78%  107M 0s
 19550K .......... .......... .......... .......... .......... 79% 6.79M 0s
 19600K .......... .......... .......... .......... .......... 79% 11.9M 0s
 19650K .......... .......... .......... .......... .......... 79% 33.9M 0s
 19700K .......... .......... .......... .......... .......... 79% 21.6M 0s
 19750K .......... .......... .......... .......... .......... 79% 2.66M 0s
 19800K .......... .......... .......... .......... .......... 80% 31.8M 0s
 19850K .......... .......... .......... .......... .......... 80% 61.9M 0s
 19900K .......... .......... .......... .......... .......... 80% 26.3M 0s
 19950K .......... .......... .......... .......... .......... 80%  110M 0s
 20000K .......... .......... .......... .......... .......... 80% 33.2M 0s
 20050K .......... .......... .......... .......... .......... 81%  104M 0s
 20100K .......... .......... .......... .......... .......... 81% 8.33M 0s
 20150K .......... .......... .......... .......... .......... 81% 13.8M 0s
 20200K .......... .......... .......... .......... .......... 81% 20.2M 0s
 20250K .......... .......... .......... .......... .......... 81% 30.5M 0s
 20300K .......... .......... .......... .......... .......... 82% 2.71M 0s
 20350K .......... .......... .......... .......... .......... 82% 22.5M 0s
 20400K .......... .......... .......... .......... .......... 82% 37.0M 0s
 20450K .......... .......... .......... .......... .......... 82% 20.9M 0s
 20500K .......... .......... .......... .......... .......... 82%  113M 0s
 20550K .......... .......... .......... .......... .......... 83% 85.3M 0s
 20600K .......... .......... .......... .......... .......... 83% 42.0M 0s
 20650K .......... .......... .......... .......... .......... 83% 45.2M 0s
 20700K .......... .......... .......... .......... .......... 83% 9.92M 0s
 20750K .......... .......... .......... .......... .......... 83% 11.1M 0s
 20800K .......... .......... .......... .......... .......... 84% 26.1M 0s
 20850K .......... .......... .......... .......... .......... 84%  925K 0s
 20900K .......... .......... .......... .......... .......... 84%  209M 0s
 20950K .......... .......... .......... .......... .......... 84%  244M 0s
 21000K .......... .......... .......... .......... .......... 84%  211M 0s
 21050K .......... .......... .......... .......... .......... 85%  252M 0s
 21100K .......... .......... .......... .......... .......... 85%  245M 0s
 21150K .......... .......... .......... .......... .......... 85%  238M 0s
 21200K .......... .......... .......... .......... .......... 85%  188M 0s
 21250K .......... .......... .......... .......... .......... 85%  242M 0s
 21300K .......... .......... .......... .......... .......... 86%  258M 0s
 21350K .......... .......... .......... .......... .......... 86%  246M 0s
 21400K .......... .......... .......... .......... .......... 86%  220M 0s
 21450K .......... .......... .......... .......... .......... 86%  210M 0s
 21500K .......... .......... .......... .......... .......... 86% 13.4M 0s
 21550K .......... .......... .......... .......... .......... 87% 17.6M 0s
 21600K .......... .......... .......... .......... .......... 87% 15.2M 0s
 21650K .......... .......... .......... .......... .......... 87% 43.9M 0s
 21700K .......... .......... .......... .......... .......... 87% 41.5M 0s
 21750K .......... .......... .......... .......... .......... 87% 38.4M 0s
 21800K .......... .......... .......... .......... .......... 88% 6.11M 0s
 21850K ......
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.... .......... .......... .......... .......... 88% 10.9M 0s
 21900K .......... .......... .......... .......... .......... 88% 2.75M 0s
 21950K .......... .......... .......... .......... .......... 88% 19.5M 0s
 22000K .......... .......... .......... .......... .......... 88% 14.5M 0s
 22050K .......... .......... .......... .......... .......... 89% 86.0M 0s
 22100K .......... .......... .......... .......... .......... 89% 32.6M 0s
 22150K .......... .......... .......... .......... .......... 89% 34.3M 0s
 22200K .......... .......... .......... .......... .......... 89% 5.31M 0s
 22250K .......... .......... .......... .......... .......... 89% 12.7M 0s
 22300K .......... .......... .......... .......... .......... 90%  107M 0s
 22350K .......... .......... .......... .......... .......... 90% 2.72M 0s
 22400K .......... .......... .......... .......... .......... 90% 10.3M 0s
 22450K .......... .......... .......... .......... .......... 90%  114M 0s
 22500K .......... .......... .......... .......... .......... 90% 37.7M 0s
 22550K .......... .......... .......... .......... .......... 91% 65.7M 0s
 22600K .......... .......... .......... .......... .......... 91% 25.8M 0s
 22650K .......... .......... .......... .......... .......... 91% 5.45M 0s
 22700K .......... .......... .......... .......... .......... 91% 13.8M 0s
 22750K .......... .......... .......... .......... .......... 91% 2.83M 0s
 22800K .......... .......... .......... .......... .......... 92% 18.0M 0s
 22850K .......... .......... .......... .......... .......... 92% 14.1M 0s
 22900K .......... .......... .......... .......... .......... 92%  116M 0s
 22950K .......... .......... .......... .......... .......... 92% 38.7M 0s
 23000K .......... .......... .......... .......... .......... 92% 32.4M 0s
 23050K .......... .......... .......... .......... .......... 93% 5.11M 0s
 23100K .......... .......... .......... .......... .......... 93% 15.6M 0s
 23150K .......... .......... .......... .......... .......... 93% 4.59M 0s
 23200K .......... .......... .......... .......... .......... 93% 5.00M 0s
 23250K .......... .......... .......... .......... .......... 93% 14.7M 0s
 23300K .......... .......... .......... .......... .......... 94% 97.8M 0s
 23350K .......... .......... .......... .......... .......... 94% 67.9M 0s
 23400K .......... .......... .......... .......... .......... 94% 36.2M 0s
 23450K .......... .......... .......... .......... .......... 94% 4.73M 0s
 23500K .......... .......... .......... .......... .......... 94% 98.1M 0s
 23550K .......... .......... .......... .......... .......... 95% 15.0M 0s
 23600K .......... .......... .......... .......... .......... 95% 2.55M 0s
 23650K .......... .......... .......... .......... .......... 95% 38.9M 0s
 23700K .......... .......... .......... .......... .......... 95% 16.6M 0s
 23750K .......... .......... .......... .......... .......... 95% 69.6M 0s
 23800K .......... .......... .......... .......... .......... 96% 10.6M 0s
 23850K .......... .......... .......... .......... .......... 96% 98.4M 0s
 23900K .......... .......... .......... .......... .......... 96% 6.84M 0s
 23950K .......... .......... .......... ....
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...... .......... 96% 15.2M 0s
 24000K .......... .......... .......... .......... .......... 96% 2.86M 0s
 24050K .......... .......... .......... .......... .......... 97% 14.3M 0s
 24100K .......... .......... .......... .......... .......... 97% 17.4M 0s
 24150K .......... .......... .......... .......... .......... 97% 79.3M 0s
 24200K .......... .......... .......... .......... .......... 97% 75.2M 0s
 24250K .......... .......... .......... .......... .......... 97% 10.4M 0s
 24300K .......... .......... .......... .......... .......... 98% 7.25M 0s
 24350K .......... .......... .......... .......... .......... 98% 46.7M 0s
 24400K .......... .......... .......... .......... .......... 98% 3.89M 0s
 24450K .......... .......... .......... .......... .......... 98% 6.20M 0s
 24500K .......... .......... .......... .......... .......... 98% 17.3M 0s
 24550K .......... .......... .......... .......... .......... 99% 15.2M 0s
 24600K .......... .......... .......... .......... .......... 99% 78.4M 0s
 24650K .......... .......... .......... .......... .......... 99% 11.1M 0s
 24700K .......... .......... .......... .......... .......... 99% 56.4M 0s
 24750K .......... .......... .......... .......... .......... 99% 7.07M 0s
 24800K ...                                                   100% 55.7M=2.1s

2024-04-01 23:10:19 (11.8 MB/s) - ‘gistemp1200_GHCNv4_ERSSTv5.nc.gz’ saved [25398620/25398620]
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 112MB
Dimensions:      (lat: 90, lon: 180, time: 1730, nv: 2)
Coordinates:
  * lat          (lat) float32 360B -89.0 -87.0 -85.0 -83.0 ... 85.0 87.0 89.0
  * lon          (lon) float32 720B -179.0 -177.0 -175.0 ... 175.0 177.0 179.0
  * time         (time) datetime64[ns] 14kB 1880-01-15 1880-02-15 ... 2024-02-15
Dimensions without coordinates: nv
Data variables:
    time_bnds    (time, nv) datetime64[ns] 28kB 1880-01-01 ... 2024-03-01
    tempanomaly  (time, lat, lon) float32 112MB nan nan nan ... 7.88 7.88 7.88
Attributes:
    title:        GISTEMP Surface Temperature Analysis
    institution:  NASA Goddard Institute for Space Studies
    source:       http://data.giss.nasa.gov/gistemp/
    Conventions:  CF-1.6
    history:      Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200,...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-36418455-db3c-48d9-a6e0-23e2d0be3405' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-36418455-db3c-48d9-a6e0-23e2d0be3405' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>lon</span>: 180</li><li><span class='xr-has-index'>time</span>: 1730</li><li><span>nv</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-798f49ff-5f41-4181-8e9a-941d15aee9f5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-798f49ff-5f41-4181-8e9a-941d15aee9f5' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-5902c66d-c0d8-4ac3-aa6e-8ecf34d16ba2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5902c66d-c0d8-4ac3-aa6e-8ecf34d16ba2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a861370e-bd52-4f22-97fe-56903328e163' class='xr-var-data-in' type='checkbox'><label for='data-a861370e-bd52-4f22-97fe-56903328e163' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.0 -177.0 ... 177.0 179.0</div><input id='attrs-7d44f1cd-51c1-4524-9948-214e9994df08' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7d44f1cd-51c1-4524-9948-214e9994df08' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6f46386-5cc6-4c37-89c4-61ba2b00e396' class='xr-var-data-in' type='checkbox'><label for='data-e6f46386-5cc6-4c37-89c4-61ba2b00e396' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-179., -177., -175., -173., -171., -169., -167., -165., -163., -161.,
       -159., -157., -155., -153., -151., -149., -147., -145., -143., -141.,
       -139., -137., -135., -133., -131., -129., -127., -125., -123., -121.,
       -119., -117., -115., -113., -111., -109., -107., -105., -103., -101.,
        -99.,  -97.,  -95.,  -93.,  -91.,  -89.,  -87.,  -85.,  -83.,  -81.,
        -79.,  -77.,  -75.,  -73.,  -71.,  -69.,  -67.,  -65.,  -63.,  -61.,
        -59.,  -57.,  -55.,  -53.,  -51.,  -49.,  -47.,  -45.,  -43.,  -41.,
        -39.,  -37.,  -35.,  -33.,  -31.,  -29.,  -27.,  -25.,  -23.,  -21.,
        -19.,  -17.,  -15.,  -13.,  -11.,   -9.,   -7.,   -5.,   -3.,   -1.,
          1.,    3.,    5.,    7.,    9.,   11.,   13.,   15.,   17.,   19.,
         21.,   23.,   25.,   27.,   29.,   31.,   33.,   35.,   37.,   39.,
         41.,   43.,   45.,   47.,   49.,   51.,   53.,   55.,   57.,   59.,
         61.,   63.,   65.,   67.,   69.,   71.,   73.,   75.,   77.,   79.,
         81.,   83.,   85.,   87.,   89.,   91.,   93.,   95.,   97.,   99.,
        101.,  103.,  105.,  107.,  109.,  111.,  113.,  115.,  117.,  119.,
        121.,  123.,  125.,  127.,  129.,  131.,  133.,  135.,  137.,  139.,
        141.,  143.,  145.,  147.,  149.,  151.,  153.,  155.,  157.,  159.,
        161.,  163.,  165.,  167.,  169.,  171.,  173.,  175.,  177.,  179.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-15 ... 2024-02-15</div><input id='attrs-fbb75dfe-da67-4bfa-a1bc-bfc8b3ac4ec7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fbb75dfe-da67-4bfa-a1bc-bfc8b3ac4ec7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a800dc4-6312-4852-8691-0b18e99a5dc9' class='xr-var-data-in' type='checkbox'><label for='data-0a800dc4-6312-4852-8691-0b18e99a5dc9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1880-01-15T00:00:00.000000000&#x27;, &#x27;1880-02-15T00:00:00.000000000&#x27;,
       &#x27;1880-03-15T00:00:00.000000000&#x27;, ..., &#x27;2023-12-15T00:00:00.000000000&#x27;,
       &#x27;2024-01-15T00:00:00.000000000&#x27;, &#x27;2024-02-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3a96d5c3-601e-4795-a20f-f58dcfc17bd7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3a96d5c3-601e-4795-a20f-f58dcfc17bd7' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, nv)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-01 ... 2024-03-01</div><input id='attrs-3f2bf20f-8191-4fe9-a793-ee2ffcc5460b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3f2bf20f-8191-4fe9-a793-ee2ffcc5460b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-300bde61-819c-4784-8cd3-f05cdc10174d' class='xr-var-data-in' type='checkbox'><label for='data-300bde61-819c-4784-8cd3-f05cdc10174d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[&#x27;1880-01-01T00:00:00.000000000&#x27;, &#x27;1880-02-01T00:00:00.000000000&#x27;],
       [&#x27;1880-02-01T00:00:00.000000000&#x27;, &#x27;1880-03-01T00:00:00.000000000&#x27;],
       [&#x27;1880-03-01T00:00:00.000000000&#x27;, &#x27;1880-04-01T00:00:00.000000000&#x27;],
       ...,
       [&#x27;2023-12-01T00:00:00.000000000&#x27;, &#x27;2024-01-01T00:00:00.000000000&#x27;],
       [&#x27;2024-01-01T00:00:00.000000000&#x27;, &#x27;2024-02-01T00:00:00.000000000&#x27;],
       [&#x27;2024-02-01T00:00:00.000000000&#x27;, &#x27;2024-03-01T00:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 7.88 7.88 7.88</div><input id='attrs-1485415e-9bfe-4158-9301-39a2c43a9da0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1485415e-9bfe-4158-9301-39a2c43a9da0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84db6096-51e9-439b-b812-a61b02b0db66' class='xr-var-data-in' type='checkbox'><label for='data-84db6096-51e9-439b-b812-a61b02b0db66' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
...
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ],
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ],
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ]],

       [[-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        [-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        [-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        ...,
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996],
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996],
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-43049a16-7e08-4750-9ded-8255abd048a1' class='xr-section-summary-in' type='checkbox'  ><label for='section-43049a16-7e08-4750-9ded-8255abd048a1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-73724dcb-379d-42da-b14d-c662cfa4a3dc' class='xr-index-data-in' type='checkbox'/><label for='index-73724dcb-379d-42da-b14d-c662cfa4a3dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0, -79.0, -77.0, -75.0, -73.0, -71.0,
       -69.0, -67.0, -65.0, -63.0, -61.0, -59.0, -57.0, -55.0, -53.0, -51.0,
       -49.0, -47.0, -45.0, -43.0, -41.0, -39.0, -37.0, -35.0, -33.0, -31.0,
       -29.0, -27.0, -25.0, -23.0, -21.0, -19.0, -17.0, -15.0, -13.0, -11.0,
        -9.0,  -7.0,  -5.0,  -3.0,  -1.0,   1.0,   3.0,   5.0,   7.0,   9.0,
        11.0,  13.0,  15.0,  17.0,  19.0,  21.0,  23.0,  25.0,  27.0,  29.0,
        31.0,  33.0,  35.0,  37.0,  39.0,  41.0,  43.0,  45.0,  47.0,  49.0,
        51.0,  53.0,  55.0,  57.0,  59.0,  61.0,  63.0,  65.0,  67.0,  69.0,
        71.0,  73.0,  75.0,  77.0,  79.0,  81.0,  83.0,  85.0,  87.0,  89.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-30fe374d-bee1-4a6f-8ee9-1dc270757a66' class='xr-index-data-in' type='checkbox'/><label for='index-30fe374d-bee1-4a6f-8ee9-1dc270757a66' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.0, -177.0, -175.0, -173.0, -171.0, -169.0, -167.0, -165.0, -163.0,
       -161.0,
       ...
        161.0,  163.0,  165.0,  167.0,  169.0,  171.0,  173.0,  175.0,  177.0,
        179.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-dcab4eb7-1370-44ee-937c-5d2b4fd86d34' class='xr-index-data-in' type='checkbox'/><label for='index-dcab4eb7-1370-44ee-937c-5d2b4fd86d34' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1880-01-15&#x27;, &#x27;1880-02-15&#x27;, &#x27;1880-03-15&#x27;, &#x27;1880-04-15&#x27;,
               &#x27;1880-05-15&#x27;, &#x27;1880-06-15&#x27;, &#x27;1880-07-15&#x27;, &#x27;1880-08-15&#x27;,
               &#x27;1880-09-15&#x27;, &#x27;1880-10-15&#x27;,
               ...
               &#x27;2023-05-15&#x27;, &#x27;2023-06-15&#x27;, &#x27;2023-07-15&#x27;, &#x27;2023-08-15&#x27;,
               &#x27;2023-09-15&#x27;, &#x27;2023-10-15&#x27;, &#x27;2023-11-15&#x27;, &#x27;2023-12-15&#x27;,
               &#x27;2024-01-15&#x27;, &#x27;2024-02-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1730, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-24bf7703-6614-469c-bb70-13ee620e7175' class='xr-section-summary-in' type='checkbox'  checked><label for='section-24bf7703-6614-469c-bb70-13ee620e7175' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>GISTEMP Surface Temperature Analysis</dd><dt><span>institution :</span></dt><dd>NASA Goddard Institute for Space Studies</dd><dt><span>source :</span></dt><dd>http://data.giss.nasa.gov/gistemp/</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200, IOCEAN=NCDC/ER5, Base: 1951-1980</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Remap longitude range from [-180, 180] to [0, 360] for plotting purposes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="p">((</span><span class="n">ds</span><span class="o">.</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 112MB
Dimensions:      (lat: 90, time: 1730, nv: 2, lon: 180)
Coordinates:
  * lat          (lat) float32 360B -89.0 -87.0 -85.0 -83.0 ... 85.0 87.0 89.0
  * time         (time) datetime64[ns] 14kB 1880-01-15 1880-02-15 ... 2024-02-15
  * lon          (lon) float32 720B 1.0 3.0 5.0 7.0 ... 353.0 355.0 357.0 359.0
Dimensions without coordinates: nv
Data variables:
    time_bnds    (time, nv) datetime64[ns] 28kB 1880-01-01 ... 2024-03-01
    tempanomaly  (time, lat, lon) float32 112MB nan nan nan ... 7.88 7.88 7.88
Attributes:
    title:        GISTEMP Surface Temperature Analysis
    institution:  NASA Goddard Institute for Space Studies
    source:       http://data.giss.nasa.gov/gistemp/
    Conventions:  CF-1.6
    history:      Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200,...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6663d86a-a4ab-4024-853f-7a2c1d6caa55' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6663d86a-a4ab-4024-853f-7a2c1d6caa55' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>time</span>: 1730</li><li><span>nv</span>: 2</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-80340767-3c24-4e96-b3c7-6b1ab3fdec10' class='xr-section-summary-in' type='checkbox'  checked><label for='section-80340767-3c24-4e96-b3c7-6b1ab3fdec10' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-07047e06-5277-4a17-98d2-81b035cfbf78' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-07047e06-5277-4a17-98d2-81b035cfbf78' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b5a94d0-2d1f-481f-bbd6-77832011773a' class='xr-var-data-in' type='checkbox'><label for='data-1b5a94d0-2d1f-481f-bbd6-77832011773a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-15 ... 2024-02-15</div><input id='attrs-496aa4a3-4f5d-4590-b2aa-620d2c4a95eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-496aa4a3-4f5d-4590-b2aa-620d2c4a95eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67cf5b86-b8df-4923-b415-79b14c0796b4' class='xr-var-data-in' type='checkbox'><label for='data-67cf5b86-b8df-4923-b415-79b14c0796b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1880-01-15T00:00:00.000000000&#x27;, &#x27;1880-02-15T00:00:00.000000000&#x27;,
       &#x27;1880-03-15T00:00:00.000000000&#x27;, ..., &#x27;2023-12-15T00:00:00.000000000&#x27;,
       &#x27;2024-01-15T00:00:00.000000000&#x27;, &#x27;2024-02-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.0 3.0 5.0 ... 355.0 357.0 359.0</div><input id='attrs-4cf769ec-cf97-4d3e-b42a-2b902a379c53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4cf769ec-cf97-4d3e-b42a-2b902a379c53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e9de9f2-90b2-4ca0-b72a-3931b39dca2a' class='xr-var-data-in' type='checkbox'><label for='data-9e9de9f2-90b2-4ca0-b72a-3931b39dca2a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1.,   3.,   5.,   7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,
        25.,  27.,  29.,  31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,
        49.,  51.,  53.,  55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,
        73.,  75.,  77.,  79.,  81.,  83.,  85.,  87.,  89.,  91.,  93.,  95.,
        97.,  99., 101., 103., 105., 107., 109., 111., 113., 115., 117., 119.,
       121., 123., 125., 127., 129., 131., 133., 135., 137., 139., 141., 143.,
       145., 147., 149., 151., 153., 155., 157., 159., 161., 163., 165., 167.,
       169., 171., 173., 175., 177., 179., 181., 183., 185., 187., 189., 191.,
       193., 195., 197., 199., 201., 203., 205., 207., 209., 211., 213., 215.,
       217., 219., 221., 223., 225., 227., 229., 231., 233., 235., 237., 239.,
       241., 243., 245., 247., 249., 251., 253., 255., 257., 259., 261., 263.,
       265., 267., 269., 271., 273., 275., 277., 279., 281., 283., 285., 287.,
       289., 291., 293., 295., 297., 299., 301., 303., 305., 307., 309., 311.,
       313., 315., 317., 319., 321., 323., 325., 327., 329., 331., 333., 335.,
       337., 339., 341., 343., 345., 347., 349., 351., 353., 355., 357., 359.],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-46fee930-77e2-426d-adfc-d8647f5b509a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46fee930-77e2-426d-adfc-d8647f5b509a' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, nv)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-01 ... 2024-03-01</div><input id='attrs-59921f4e-e239-4e33-8af7-746c48757c4c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-59921f4e-e239-4e33-8af7-746c48757c4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e80ddd73-9971-4fcf-bbf7-3c694558cd10' class='xr-var-data-in' type='checkbox'><label for='data-e80ddd73-9971-4fcf-bbf7-3c694558cd10' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[&#x27;1880-01-01T00:00:00.000000000&#x27;, &#x27;1880-02-01T00:00:00.000000000&#x27;],
       [&#x27;1880-02-01T00:00:00.000000000&#x27;, &#x27;1880-03-01T00:00:00.000000000&#x27;],
       [&#x27;1880-03-01T00:00:00.000000000&#x27;, &#x27;1880-04-01T00:00:00.000000000&#x27;],
       ...,
       [&#x27;2023-12-01T00:00:00.000000000&#x27;, &#x27;2024-01-01T00:00:00.000000000&#x27;],
       [&#x27;2024-01-01T00:00:00.000000000&#x27;, &#x27;2024-02-01T00:00:00.000000000&#x27;],
       [&#x27;2024-02-01T00:00:00.000000000&#x27;, &#x27;2024-03-01T00:00:00.000000000&#x27;]],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 7.88 7.88 7.88</div><input id='attrs-7980c522-9e96-4e7f-bf40-560e5b45f0c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7980c522-9e96-4e7f-bf40-560e5b45f0c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa38aa63-de75-4acf-9133-f9fa98b44c6c' class='xr-var-data-in' type='checkbox'><label for='data-fa38aa63-de75-4acf-9133-f9fa98b44c6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
...
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ],
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ],
        [ 2.83     ,  2.83     ,  2.83     , ...,  2.83     ,
          2.83     ,  2.83     ]],

       [[-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        [-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        [-2.1      , -2.1      , -2.1      , ..., -2.1      ,
         -2.1      , -2.1      ],
        ...,
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996],
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996],
        [ 7.8799996,  7.8799996,  7.8799996, ...,  7.8799996,
          7.8799996,  7.8799996]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b1bfc4e3-5d45-4049-9b16-cf3f90cc5bb1' class='xr-section-summary-in' type='checkbox'  ><label for='section-b1bfc4e3-5d45-4049-9b16-cf3f90cc5bb1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-61187359-aea2-450c-a7bf-68e1ee73bf21' class='xr-index-data-in' type='checkbox'/><label for='index-61187359-aea2-450c-a7bf-68e1ee73bf21' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0, -79.0, -77.0, -75.0, -73.0, -71.0,
       -69.0, -67.0, -65.0, -63.0, -61.0, -59.0, -57.0, -55.0, -53.0, -51.0,
       -49.0, -47.0, -45.0, -43.0, -41.0, -39.0, -37.0, -35.0, -33.0, -31.0,
       -29.0, -27.0, -25.0, -23.0, -21.0, -19.0, -17.0, -15.0, -13.0, -11.0,
        -9.0,  -7.0,  -5.0,  -3.0,  -1.0,   1.0,   3.0,   5.0,   7.0,   9.0,
        11.0,  13.0,  15.0,  17.0,  19.0,  21.0,  23.0,  25.0,  27.0,  29.0,
        31.0,  33.0,  35.0,  37.0,  39.0,  41.0,  43.0,  45.0,  47.0,  49.0,
        51.0,  53.0,  55.0,  57.0,  59.0,  61.0,  63.0,  65.0,  67.0,  69.0,
        71.0,  73.0,  75.0,  77.0,  79.0,  81.0,  83.0,  85.0,  87.0,  89.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5fa6cb73-6603-468c-adf1-3de50b642fe9' class='xr-index-data-in' type='checkbox'/><label for='index-5fa6cb73-6603-468c-adf1-3de50b642fe9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1880-01-15&#x27;, &#x27;1880-02-15&#x27;, &#x27;1880-03-15&#x27;, &#x27;1880-04-15&#x27;,
               &#x27;1880-05-15&#x27;, &#x27;1880-06-15&#x27;, &#x27;1880-07-15&#x27;, &#x27;1880-08-15&#x27;,
               &#x27;1880-09-15&#x27;, &#x27;1880-10-15&#x27;,
               ...
               &#x27;2023-05-15&#x27;, &#x27;2023-06-15&#x27;, &#x27;2023-07-15&#x27;, &#x27;2023-08-15&#x27;,
               &#x27;2023-09-15&#x27;, &#x27;2023-10-15&#x27;, &#x27;2023-11-15&#x27;, &#x27;2023-12-15&#x27;,
               &#x27;2024-01-15&#x27;, &#x27;2024-02-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1730, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-31df4070-e904-4c06-a68e-b39e166d6eee' class='xr-index-data-in' type='checkbox'/><label for='index-31df4070-e904-4c06-a68e-b39e166d6eee' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1.0,   3.0,   5.0,   7.0,   9.0,  11.0,  13.0,  15.0,  17.0,  19.0,
       ...
       341.0, 343.0, 345.0, 347.0, 349.0, 351.0, 353.0, 355.0, 357.0, 359.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c5f49427-559c-4f88-94e2-f3fbfdf71122' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c5f49427-559c-4f88-94e2-f3fbfdf71122' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>GISTEMP Surface Temperature Analysis</dd><dt><span>institution :</span></dt><dd>NASA Goddard Institute for Space Studies</dd><dt><span>source :</span></dt><dd>http://data.giss.nasa.gov/gistemp/</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200, IOCEAN=NCDC/ER5, Base: 1951-1980</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="compute-observed-trends">
<h3>Compute observed trends<a class="headerlink" href="#compute-observed-trends" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Include only full seasons from 1979 through 2012:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_seasons</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1979&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;QS-DEC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">obs_seasons</span> <span class="o">=</span> <span class="n">obs_seasons</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1979&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">obs_winter_seasons</span> <span class="o">=</span> <span class="n">obs_seasons</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="n">obs_seasons</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">obs_seasons</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">12</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">obs_winter_seasons</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2MB
Dimensions:      (lat: 90, time: 34, lon: 180)
Coordinates:
  * lat          (lat) float32 360B -89.0 -87.0 -85.0 -83.0 ... 85.0 87.0 89.0
  * lon          (lon) float32 720B 1.0 3.0 5.0 7.0 ... 353.0 355.0 357.0 359.0
  * time         (time) datetime64[ns] 272B 1979-12-01 1980-12-01 ... 2012-12-01
Data variables:
    tempanomaly  (time, lat, lon) float32 2MB 0.5367 0.5367 0.5367 ... 7.04 7.04
Attributes:
    title:        GISTEMP Surface Temperature Analysis
    institution:  NASA Goddard Institute for Space Studies
    source:       http://data.giss.nasa.gov/gistemp/
    Conventions:  CF-1.6
    history:      Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200,...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4dcb3383-7618-443c-b987-059183ddc91b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4dcb3383-7618-443c-b987-059183ddc91b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>time</span>: 34</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ee92363e-ef1e-40b9-8fdf-54da0f7c84cd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ee92363e-ef1e-40b9-8fdf-54da0f7c84cd' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-b2e6df8e-8d76-420e-9517-4dc6a843787e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2e6df8e-8d76-420e-9517-4dc6a843787e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6ad02cb-9473-4f80-a320-9f37f6b81f94' class='xr-var-data-in' type='checkbox'><label for='data-a6ad02cb-9473-4f80-a320-9f37f6b81f94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.0 3.0 5.0 ... 355.0 357.0 359.0</div><input id='attrs-57cee403-9269-4f90-af5d-e1f377a3f158' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-57cee403-9269-4f90-af5d-e1f377a3f158' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be4ca169-9f0d-4ef5-8bea-3add8bdae46c' class='xr-var-data-in' type='checkbox'><label for='data-be4ca169-9f0d-4ef5-8bea-3add8bdae46c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1.,   3.,   5.,   7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,
        25.,  27.,  29.,  31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,
        49.,  51.,  53.,  55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,
        73.,  75.,  77.,  79.,  81.,  83.,  85.,  87.,  89.,  91.,  93.,  95.,
        97.,  99., 101., 103., 105., 107., 109., 111., 113., 115., 117., 119.,
       121., 123., 125., 127., 129., 131., 133., 135., 137., 139., 141., 143.,
       145., 147., 149., 151., 153., 155., 157., 159., 161., 163., 165., 167.,
       169., 171., 173., 175., 177., 179., 181., 183., 185., 187., 189., 191.,
       193., 195., 197., 199., 201., 203., 205., 207., 209., 211., 213., 215.,
       217., 219., 221., 223., 225., 227., 229., 231., 233., 235., 237., 239.,
       241., 243., 245., 247., 249., 251., 253., 255., 257., 259., 261., 263.,
       265., 267., 269., 271., 273., 275., 277., 279., 281., 283., 285., 287.,
       289., 291., 293., 295., 297., 299., 301., 303., 305., 307., 309., 311.,
       313., 315., 317., 319., 321., 323., 325., 327., 329., 331., 333., 335.,
       337., 339., 341., 343., 345., 347., 349., 351., 353., 355., 357., 359.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1979-12-01 ... 2012-12-01</div><input id='attrs-ed0da71d-edf6-4366-bc8b-b85e7d476cea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ed0da71d-edf6-4366-bc8b-b85e7d476cea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df2a9f11-64e5-40e7-bdc5-422c5589e8ec' class='xr-var-data-in' type='checkbox'><label for='data-df2a9f11-64e5-40e7-bdc5-422c5589e8ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1979-12-01T00:00:00.000000000&#x27;, &#x27;1980-12-01T00:00:00.000000000&#x27;,
       &#x27;1981-12-01T00:00:00.000000000&#x27;, &#x27;1982-12-01T00:00:00.000000000&#x27;,
       &#x27;1983-12-01T00:00:00.000000000&#x27;, &#x27;1984-12-01T00:00:00.000000000&#x27;,
       &#x27;1985-12-01T00:00:00.000000000&#x27;, &#x27;1986-12-01T00:00:00.000000000&#x27;,
       &#x27;1987-12-01T00:00:00.000000000&#x27;, &#x27;1988-12-01T00:00:00.000000000&#x27;,
       &#x27;1989-12-01T00:00:00.000000000&#x27;, &#x27;1990-12-01T00:00:00.000000000&#x27;,
       &#x27;1991-12-01T00:00:00.000000000&#x27;, &#x27;1992-12-01T00:00:00.000000000&#x27;,
       &#x27;1993-12-01T00:00:00.000000000&#x27;, &#x27;1994-12-01T00:00:00.000000000&#x27;,
       &#x27;1995-12-01T00:00:00.000000000&#x27;, &#x27;1996-12-01T00:00:00.000000000&#x27;,
       &#x27;1997-12-01T00:00:00.000000000&#x27;, &#x27;1998-12-01T00:00:00.000000000&#x27;,
       &#x27;1999-12-01T00:00:00.000000000&#x27;, &#x27;2000-12-01T00:00:00.000000000&#x27;,
       &#x27;2001-12-01T00:00:00.000000000&#x27;, &#x27;2002-12-01T00:00:00.000000000&#x27;,
       &#x27;2003-12-01T00:00:00.000000000&#x27;, &#x27;2004-12-01T00:00:00.000000000&#x27;,
       &#x27;2005-12-01T00:00:00.000000000&#x27;, &#x27;2006-12-01T00:00:00.000000000&#x27;,
       &#x27;2007-12-01T00:00:00.000000000&#x27;, &#x27;2008-12-01T00:00:00.000000000&#x27;,
       &#x27;2009-12-01T00:00:00.000000000&#x27;, &#x27;2010-12-01T00:00:00.000000000&#x27;,
       &#x27;2011-12-01T00:00:00.000000000&#x27;, &#x27;2012-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3b6967b8-08c6-4dcb-9d35-b2dab96d1ffb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b6967b8-08c6-4dcb-9d35-b2dab96d1ffb' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5367 0.5367 0.5367 ... 7.04 7.04</div><input id='attrs-f7d81f39-d30e-48ef-8793-d2b7ec3064c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f7d81f39-d30e-48ef-8793-d2b7ec3064c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2c1bde2-2016-40af-9f5c-069b9b792c4d' class='xr-var-data-in' type='checkbox'><label for='data-b2c1bde2-2016-40af-9f5c-069b9b792c4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[ 0.53666663,  0.53666663,  0.53666663, ...,  0.53666663,
          0.53666663,  0.53666663],
        [ 0.53666663,  0.53666663,  0.53666663, ...,  0.53666663,
          0.53666663,  0.53666663],
        [ 0.53666663,  0.53666663,  0.53666663, ...,  0.53666663,
          0.53666663,  0.53666663],
        ...,
        [ 0.26333335,  0.26333335,  0.26333335, ...,  0.26333335,
          0.26333335,  0.26333335],
        [ 0.26333335,  0.26333335,  0.26333335, ...,  0.26333335,
          0.26333335,  0.26333335],
        [ 0.26333335,  0.26333335,  0.26333335, ...,  0.26333335,
          0.26333335,  0.26333335]],

       [[ 2.5366666 ,  2.5366666 ,  2.5366666 , ...,  2.5366666 ,
          2.5366666 ,  2.5366666 ],
        [ 2.5366666 ,  2.5366666 ,  2.5366666 , ...,  2.5366666 ,
          2.5366666 ,  2.5366666 ],
        [ 2.5366666 ,  2.5366666 ,  2.5366666 , ...,  2.5366666 ,
          2.5366666 ,  2.5366666 ],
...
        [ 5.52      ,  5.52      ,  5.52      , ...,  5.52      ,
          5.52      ,  5.52      ],
        [ 5.52      ,  5.52      ,  5.52      , ...,  5.52      ,
          5.52      ,  5.52      ],
        [ 5.52      ,  5.52      ,  5.52      , ...,  5.52      ,
          5.52      ,  5.52      ]],

       [[ 3.52      ,  3.52      ,  3.52      , ...,  3.52      ,
          3.52      ,  3.52      ],
        [ 3.52      ,  3.52      ,  3.52      , ...,  3.52      ,
          3.52      ,  3.52      ],
        [ 3.52      ,  3.52      ,  3.52      , ...,  3.52      ,
          3.52      ,  3.52      ],
        ...,
        [ 7.04      ,  7.04      ,  7.04      , ...,  7.04      ,
          7.04      ,  7.04      ],
        [ 7.04      ,  7.04      ,  7.04      , ...,  7.04      ,
          7.04      ,  7.04      ],
        [ 7.04      ,  7.04      ,  7.04      , ...,  7.04      ,
          7.04      ,  7.04      ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bfe6a251-f059-4f02-b48a-d107b7af5fd9' class='xr-section-summary-in' type='checkbox'  ><label for='section-bfe6a251-f059-4f02-b48a-d107b7af5fd9' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-17010765-11b1-4038-8b4c-ce972d180827' class='xr-index-data-in' type='checkbox'/><label for='index-17010765-11b1-4038-8b4c-ce972d180827' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0, -79.0, -77.0, -75.0, -73.0, -71.0,
       -69.0, -67.0, -65.0, -63.0, -61.0, -59.0, -57.0, -55.0, -53.0, -51.0,
       -49.0, -47.0, -45.0, -43.0, -41.0, -39.0, -37.0, -35.0, -33.0, -31.0,
       -29.0, -27.0, -25.0, -23.0, -21.0, -19.0, -17.0, -15.0, -13.0, -11.0,
        -9.0,  -7.0,  -5.0,  -3.0,  -1.0,   1.0,   3.0,   5.0,   7.0,   9.0,
        11.0,  13.0,  15.0,  17.0,  19.0,  21.0,  23.0,  25.0,  27.0,  29.0,
        31.0,  33.0,  35.0,  37.0,  39.0,  41.0,  43.0,  45.0,  47.0,  49.0,
        51.0,  53.0,  55.0,  57.0,  59.0,  61.0,  63.0,  65.0,  67.0,  69.0,
        71.0,  73.0,  75.0,  77.0,  79.0,  81.0,  83.0,  85.0,  87.0,  89.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ae48582d-50f6-46d4-9941-cba5c08814da' class='xr-index-data-in' type='checkbox'/><label for='index-ae48582d-50f6-46d4-9941-cba5c08814da' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1.0,   3.0,   5.0,   7.0,   9.0,  11.0,  13.0,  15.0,  17.0,  19.0,
       ...
       341.0, 343.0, 345.0, 347.0, 349.0, 351.0, 353.0, 355.0, 357.0, 359.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1c6c6b34-7183-46d8-b547-4160aa2f88e6' class='xr-index-data-in' type='checkbox'/><label for='index-1c6c6b34-7183-46d8-b547-4160aa2f88e6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1979-12-01&#x27;, &#x27;1980-12-01&#x27;, &#x27;1981-12-01&#x27;, &#x27;1982-12-01&#x27;,
               &#x27;1983-12-01&#x27;, &#x27;1984-12-01&#x27;, &#x27;1985-12-01&#x27;, &#x27;1986-12-01&#x27;,
               &#x27;1987-12-01&#x27;, &#x27;1988-12-01&#x27;, &#x27;1989-12-01&#x27;, &#x27;1990-12-01&#x27;,
               &#x27;1991-12-01&#x27;, &#x27;1992-12-01&#x27;, &#x27;1993-12-01&#x27;, &#x27;1994-12-01&#x27;,
               &#x27;1995-12-01&#x27;, &#x27;1996-12-01&#x27;, &#x27;1997-12-01&#x27;, &#x27;1998-12-01&#x27;,
               &#x27;1999-12-01&#x27;, &#x27;2000-12-01&#x27;, &#x27;2001-12-01&#x27;, &#x27;2002-12-01&#x27;,
               &#x27;2003-12-01&#x27;, &#x27;2004-12-01&#x27;, &#x27;2005-12-01&#x27;, &#x27;2006-12-01&#x27;,
               &#x27;2007-12-01&#x27;, &#x27;2008-12-01&#x27;, &#x27;2009-12-01&#x27;, &#x27;2010-12-01&#x27;,
               &#x27;2011-12-01&#x27;, &#x27;2012-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d6607b31-e3aa-4dfb-9690-cbb29fdf8402' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d6607b31-e3aa-4dfb-9690-cbb29fdf8402' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>GISTEMP Surface Temperature Analysis</dd><dt><span>institution :</span></dt><dd>NASA Goddard Institute for Space Studies</dd><dt><span>source :</span></dt><dd>http://data.giss.nasa.gov/gistemp/</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Created 2024-03-08 11:37:27 by SBBX_to_nc 2.0 - ILAND=1200, IOCEAN=NCDC/ER5, Base: 1951-1980</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>And compute observed winter trends:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_winter_trends</span> <span class="o">=</span> <span class="n">linear_trend</span><span class="p">(</span>
    <span class="n">obs_winter_seasons</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs_winter_seasons</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="n">obs_winter_trends</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 131kB
Dimensions:      (lat: 90, lon: 180)
Coordinates:
  * lat          (lat) float32 360B -89.0 -87.0 -85.0 -83.0 ... 85.0 87.0 89.0
  * lon          (lon) float32 720B 1.0 3.0 5.0 7.0 ... 353.0 355.0 357.0 359.0
Data variables:
    tempanomaly  (lat, lon) float64 130kB 1.407 1.407 1.407 ... 5.587 5.587</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2a223c05-84c1-4be3-972b-62307e893c98' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2a223c05-84c1-4be3-972b-62307e893c98' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e945eb74-3a3b-4536-baf7-c32288426a7d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e945eb74-3a3b-4536-baf7-c32288426a7d' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-b89be8a5-be8c-497e-aca0-1896c701af7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b89be8a5-be8c-497e-aca0-1896c701af7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a463e90-2efe-4c77-abbe-1997af36e8d9' class='xr-var-data-in' type='checkbox'><label for='data-6a463e90-2efe-4c77-abbe-1997af36e8d9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.0 3.0 5.0 ... 355.0 357.0 359.0</div><input id='attrs-a2b53953-06bd-43ed-be2c-2eb80c992323' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a2b53953-06bd-43ed-be2c-2eb80c992323' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1b7b3de-538c-4050-b8f8-59d5e97fc539' class='xr-var-data-in' type='checkbox'><label for='data-c1b7b3de-538c-4050-b8f8-59d5e97fc539' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1.,   3.,   5.,   7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,
        25.,  27.,  29.,  31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,
        49.,  51.,  53.,  55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,
        73.,  75.,  77.,  79.,  81.,  83.,  85.,  87.,  89.,  91.,  93.,  95.,
        97.,  99., 101., 103., 105., 107., 109., 111., 113., 115., 117., 119.,
       121., 123., 125., 127., 129., 131., 133., 135., 137., 139., 141., 143.,
       145., 147., 149., 151., 153., 155., 157., 159., 161., 163., 165., 167.,
       169., 171., 173., 175., 177., 179., 181., 183., 185., 187., 189., 191.,
       193., 195., 197., 199., 201., 203., 205., 207., 209., 211., 213., 215.,
       217., 219., 221., 223., 225., 227., 229., 231., 233., 235., 237., 239.,
       241., 243., 245., 247., 249., 251., 253., 255., 257., 259., 261., 263.,
       265., 267., 269., 271., 273., 275., 277., 279., 281., 283., 285., 287.,
       289., 291., 293., 295., 297., 299., 301., 303., 305., 307., 309., 311.,
       313., 315., 317., 319., 321., 323., 325., 327., 329., 331., 333., 335.,
       337., 339., 341., 343., 345., 347., 349., 351., 353., 355., 357., 359.],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cd0b54da-7d24-4f22-ad2c-8f92c20afa3e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cd0b54da-7d24-4f22-ad2c-8f92c20afa3e' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.407 1.407 1.407 ... 5.587 5.587</div><input id='attrs-217639f6-e035-4d7d-98e6-2b4cc050b385' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-217639f6-e035-4d7d-98e6-2b4cc050b385' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e25caafe-e826-4650-8c80-e545dc6be872' class='xr-var-data-in' type='checkbox'><label for='data-e25caafe-e826-4650-8c80-e545dc6be872' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.40701298, 1.40701298, 1.40701298, ..., 1.40701298, 1.40701298,
        1.40701298],
       [1.40701298, 1.40701298, 1.40701298, ..., 1.40701298, 1.40701298,
        1.40701298],
       [1.40701298, 1.40701298, 1.40701298, ..., 1.40701298, 1.40701298,
        1.40701298],
       ...,
       [5.58675319, 5.58675319, 5.58675319, ..., 5.58675319, 5.58675319,
        5.58675319],
       [5.58675319, 5.58675319, 5.58675319, ..., 5.58675319, 5.58675319,
        5.58675319],
       [5.58675319, 5.58675319, 5.58675319, ..., 5.58675319, 5.58675319,
        5.58675319]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bb037943-bbd2-4ce2-b20f-db841cb2b194' class='xr-section-summary-in' type='checkbox'  ><label for='section-bb037943-bbd2-4ce2-b20f-db841cb2b194' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f0bb3dfb-d9f1-4d65-9195-49462d912b09' class='xr-index-data-in' type='checkbox'/><label for='index-f0bb3dfb-d9f1-4d65-9195-49462d912b09' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0, -79.0, -77.0, -75.0, -73.0, -71.0,
       -69.0, -67.0, -65.0, -63.0, -61.0, -59.0, -57.0, -55.0, -53.0, -51.0,
       -49.0, -47.0, -45.0, -43.0, -41.0, -39.0, -37.0, -35.0, -33.0, -31.0,
       -29.0, -27.0, -25.0, -23.0, -21.0, -19.0, -17.0, -15.0, -13.0, -11.0,
        -9.0,  -7.0,  -5.0,  -3.0,  -1.0,   1.0,   3.0,   5.0,   7.0,   9.0,
        11.0,  13.0,  15.0,  17.0,  19.0,  21.0,  23.0,  25.0,  27.0,  29.0,
        31.0,  33.0,  35.0,  37.0,  39.0,  41.0,  43.0,  45.0,  47.0,  49.0,
        51.0,  53.0,  55.0,  57.0,  59.0,  61.0,  63.0,  65.0,  67.0,  69.0,
        71.0,  73.0,  75.0,  77.0,  79.0,  81.0,  83.0,  85.0,  87.0,  89.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a30faf35-dc20-4646-adeb-148ad7006a5d' class='xr-index-data-in' type='checkbox'/><label for='index-a30faf35-dc20-4646-adeb-148ad7006a5d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1.0,   3.0,   5.0,   7.0,   9.0,  11.0,  13.0,  15.0,  17.0,  19.0,
       ...
       341.0, 343.0, 345.0, 347.0, 349.0, 351.0, 353.0, 355.0, 357.0, 359.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9c90411c-aba7-4816-9847-64b55b1b0252' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9c90411c-aba7-4816-9847-64b55b1b0252' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="plotting-figure-4">
<h3>Plotting Figure 4<a class="headerlink" href="#plotting-figure-4" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>Global maps of historical (1979 - 2012) boreal winter (DJF) surface air trends:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contour_levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">color_map</span> <span class="o">=</span> <span class="n">cmaps</span><span class="o">.</span><span class="n">ncl_default</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_map_plot</span><span class="p">(</span><span class="n">nplot_rows</span><span class="p">,</span> <span class="n">nplot_cols</span><span class="p">,</span> <span class="n">plot_index</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plot_label</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create a single map subplot. &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nplot_rows</span><span class="p">,</span> <span class="n">nplot_cols</span><span class="p">,</span> <span class="n">plot_index</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span> <span class="o">=</span> <span class="mi">180</span><span class="p">))</span>
    <span class="n">cplot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                         <span class="n">levels</span> <span class="o">=</span> <span class="n">contour_levels</span><span class="p">,</span>
                         <span class="n">cmap</span> <span class="o">=</span> <span class="n">color_map</span><span class="p">,</span>
                         <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
                         <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">plot_label</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cplot</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Generate plot (may take a while as many individual maps are generated)</span>
<span class="n">numPlotRows</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">numPlotCols</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">figWidth</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">figHeight</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">numPlotRows</span><span class="p">,</span> <span class="n">numPlotCols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figWidth</span><span class="p">,</span><span class="n">figHeight</span><span class="p">))</span>

<span class="n">lats</span> <span class="o">=</span> <span class="n">winter_trends</span><span class="o">.</span><span class="n">lat</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">winter_trends</span><span class="o">.</span><span class="n">lon</span>

<span class="c1"># Create ensemble member plots</span>
<span class="k">for</span> <span class="n">ensemble_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">plot_data</span> <span class="o">=</span> <span class="n">winter_trends</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">member_id</span> <span class="o">=</span> <span class="n">ensemble_index</span><span class="p">)</span>
    <span class="n">plot_index</span> <span class="o">=</span> <span class="n">ensemble_index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">plot_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plot_index</span><span class="p">)</span>
    <span class="n">plotRow</span> <span class="o">=</span> <span class="n">ensemble_index</span> <span class="o">//</span> <span class="n">numPlotCols</span>
    <span class="n">plotCol</span> <span class="o">=</span> <span class="n">ensemble_index</span> <span class="o">%</span> <span class="n">numPlotCols</span>
    <span class="c1"># Retain axes objects for figure colorbar</span>
    <span class="n">cplot</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="n">plotRow</span><span class="p">,</span> <span class="n">plotCol</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_map_plot</span><span class="p">(</span><span class="n">numPlotRows</span><span class="p">,</span> <span class="n">numPlotCols</span><span class="p">,</span> <span class="n">plot_index</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_label</span><span class="p">)</span>

<span class="c1"># Create plots for the ensemble mean, observations, and a figure color bar.</span>
<span class="n">cplot</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_map_plot</span><span class="p">(</span><span class="n">numPlotRows</span><span class="p">,</span> <span class="n">numPlotCols</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="n">winter_trends_mean</span><span class="p">,</span> <span class="s1">&#39;EM&#39;</span><span class="p">)</span>

<span class="n">lats</span> <span class="o">=</span> <span class="n">obs_winter_trends</span><span class="o">.</span><span class="n">lat</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">obs_winter_trends</span><span class="o">.</span><span class="n">lon</span>
<span class="n">cplot</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_map_plot</span><span class="p">(</span><span class="n">numPlotRows</span><span class="p">,</span> <span class="n">numPlotCols</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">obs_winter_trends</span><span class="o">.</span><span class="n">tempanomaly</span><span class="p">,</span> <span class="s1">&#39;OBS&#39;</span><span class="p">)</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cplot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1979-2012 DJF surface air temperature trends (K/34 years)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">contour_levels</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">contour_levels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 35s, sys: 5.07 s, total: 1min 40s
Wall time: 1min 35s
</pre></div>
</div>
<img alt="../../_images/dda97ffbed84bdea426e5865b0fe357061c9d2884e704ddc16e281cfa92b4a08.png" src="../../_images/dda97ffbed84bdea426e5865b0fe357061c9d2884e704ddc16e281cfa92b4a08.png" />
</div>
</div>
<p>Close our client:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>In this notebook, we used CESM LENS data hosted on AWS to recreate two key figures in the paper that describes the project.</p>
<section id="whats-next">
<h3>What’s next?<a class="headerlink" href="#whats-next" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>More example workflows using these datasets may be added in the future.</p>
</section>
</section>
<section id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p><a class="reference external" href="https://gallery.pangeo.io/repos/NCAR/cesm-lens-aws/notebooks/kay-et-al-2015.v3.html">Original notebook in the Pangeo Gallery</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/example-workflows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                  </article>

                
                

                
                
                  <footer class="prev-next-footer">
                    
<div class="prev-next-area">
    <a class="left-prev"
       href="../foundations/enhanced-catalog.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Enhanced Intake-ESM Catalog Demo</p>
      </div>
    </a>
</div>
                  </footer>
                
              </div>

              
              
                
                  <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-and-connect-to-dask-distributed-cluster">Create and Connect to Dask Distributed Cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-data">Load and Prepare Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-data-needed-to-construct-figure-2">Extract data needed to construct Figure 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figure-2">Figure 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-grid-cell-areas">Read grid cell areas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-weighted-means">Define weighted means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-data-and-compute-means">Read data and compute means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-observations-for-figure-2-hadcrut4-morice-et-al-2012">Get observations for Figure 2 (HadCRUT4; Morice et al. 2012)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-figure-2">Plotting Figure 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figure-4">Figure 4</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-linear-trend-for-winter-seasons">Compute linear trend for winter seasons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ensemble-trends">Compute ensemble trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-observations-for-figure-4-nasa-giss-gistemp">Get observations for Figure 4 (NASA GISS GisTemp)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-observed-trends">Compute observed trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-figure-4">Plotting Figure 4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-next">What’s next?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
  </nav></div>

</div></div>
                
              


                
                <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://binder.projectpythia.org/v2/gh/ProjectPythia/cesm-lens-aws-cookbook/main?urlpath=lab/tree/notebooks/example-workflows/key-figures.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ProjectPythia/cesm-lens-aws-cookbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ProjectPythia/cesm-lens-aws-cookbook/edit/main/notebooks/example-workflows/key-figures.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ProjectPythia/cesm-lens-aws-cookbook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/example-workflows/key-figures.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/example-workflows/key-figures.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
            </div>

            <footer class="bd-footer-content">
              
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the <a href="https://projectpythia.org/">Project Pythia</a> Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 1 April 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
            </footer>

        </main>
    </div>
  </div>
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
     
  
  
  
  
    <div class="footer-items__start">
      <div class="container-fluid m-0 p-0">
      
        <div class="footer-item">
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NSF-NCAR_Lockup-UCAR-Dark_102523.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAlbany" src="../../_images/UAlbany-A2-logo-purple-gold.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div></div>
      
        <div class="footer-item">  <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2024.
        
          By the <a href="https://projectpythia.org/">Project Pythia</a> Community.
        
          Last updated on 1 April 2024.
        </p>
      </div>
    </div>
  </div></div>
      
      </div>
    </div>
  

  </footer>
  </body>
</html>